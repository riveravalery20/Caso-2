---
title: "An√°lisis Profesional"
author: "Melany Enriquez (2415897)
Santiago Posada (2418914)
Sof√≠a Potos√≠ (2417794)
Valery Rivera (2417038)"
date: "2025-10-27"
output:
  rmdformats::readthedown:
    css: Valery-styles.css
    self_contained: true
    thumbnails: false
    gallery: false
    number_sections: false
    toc_depth: 3
    use_bookdown: false
---

```{r librerias, warning=FALSE,message=FALSE}
library(kableExtra)
library(readr)
library(dplyr)
library(tidyverse)
library(kableExtra)
library(reactable)
library(plotly)
library(htmltools)
library(ggplot2)
```

```{r tema 5, echo=FALSE}
Valery_css =
"  
/* PALETA ACAD√âMICA MARINA PROFESIONAL */
:root {
  --deep-ocean: #2C5F7A;         /* Azul marino profundo */
  --ocean-teal: #3A8E96;         /* Verde azulado principal */
  --sea-glass: #4FB0A8;          /* Turquesa suave */
  --seafoam: #8FD4C1;            /* Espuma de mar */
  --mist: #F8FCFB;               /* Blanco acad√©mico con tono marino suave */
  --parchment: #FDFDF6;          /* Color pergamino acad√©mico */
  --coral: #D94E4E;              /* Acento coral sobrio */
  --dark-ink: #2C3E50;           /* Color tinta para texto */
  --light-ink: #4A6572;          /* Texto secundario */
  --border-light: #E1F0ED;       /* Bordes sutiles */
  --accent-gold: #C4A747;        /* Dorado acad√©mico */
}

/* IMPORTAR FUENTES ACAD√âMICAS */
@import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&family=Source+Serif+Pro:wght@300;400;600&family=Lato:wght@300;400;700&display=swap');

/* ESTILOS BASE ACAD√âMICOS */
body {
  font-family: 'Source Serif Pro', 'Georgia', 'Times New Roman', serif;
  font-weight: 400;
  line-height: 1.7;
  color: var(--dark-ink);
  background-color: var(--parchment);
  font-size: 17px;
  text-align: justify;
}

.main-content {
  max-width: 1200px;
  margin: 2rem auto;
  padding: 3rem;
  background: var(--mist);
  box-shadow: 
    0 5px 30px rgba(42, 95, 122, 0.08),
    0 1px 3px rgba(0,0,0,0.03);
  border-radius: 4px;
  border: 1px solid var(--border-light);
  position: relative;
}

/* ENCABEZADOS ACAD√âMICOS */
h1, h2, h3, h4, h5, h6 {
  font-family: 'Merriweather', 'Georgia', 'Times New Roman', serif;
  color: var(--deep-ocean) !important;
  margin-top: 2.5rem;
  margin-bottom: 1.2rem;
  font-weight: 600;
  line-height: 1.3;
  text-align: left;
}

h1 {
  font-size: 2.6rem;
  font-weight: 700;
  text-align: center;
  margin-bottom: 2rem;
  padding-bottom: 1.2rem;
  border-bottom: 3px double var(--sea-glass);
  color: var(--deep-ocean) !important;
  background: none;
  -webkit-text-fill-color: var(--deep-ocean);
  letter-spacing: -0.5px;
}

h2 {
  font-size: 2rem;
  border-left: 4px solid var(--ocean-teal);
  padding-left: 1.2rem;
  margin-top: 3rem;
  background: linear-gradient(90deg, rgba(79, 176, 168, 0.08) 0%, transparent 100%);
  padding: 0.8rem 1.2rem;
  border-radius: 0;
  position: relative;
  font-weight: 600;
}

h3 {
  font-size: 1.5rem;
  color: var(--ocean-teal) !important;
  border-bottom: 1px solid var(--border-light);
  padding-bottom: 0.5rem;
  margin-top: 2.2rem;
  font-weight: 600;
}

h4 {
  font-size: 1.3rem;
  color: var(--sea-glass) !important;
  margin-top: 1.8rem;
  font-style: italic;
}

h5 {
  font-size: 1.1rem;
  color: var(--light-ink) !important;
  margin-top: 1.5rem;
}

/* TOC Y SIDEBAR - ARREGLO COMPLETO PARA R MARKDOWN */

/* Sidebar principal */
.sidebar, #sidebar, .col-sm-3, .tocify {
  background: linear-gradient(135deg, var(--mist) 0%, #F0F9F7 100%) !important;
  border-right: 2px solid var(--border-light) !important;
  padding: 1.5rem !important;
}

/* Contenedor del TOC */
#TOC, .tocify, .list-group {
  background: transparent !important;
  border: none !important;
  padding: 0 !important;
  margin: 0 !important;
  width: 100% !important;
}

/* Items del TOC - TODOS LOS NIVELES */
#TOC ul, 
#TOC li, 
.tocify ul, 
.tocify li, 
.list-group-item {
  background: transparent !important;
  border: none !important;
  margin: 0 !important;
  padding: 0 !important;
  list-style: none !important;
  display: block !important;
  width: 100% !important;
}

/* Enlaces del TOC - NIVEL 1 */
#TOC > ul > li > a,
.tocify-header > a,
.list-group-item > a {
  color: var(--deep-ocean) !important;
  background: transparent !important;
  border: none !important;
  padding: 0.8rem 1rem !important;
  margin: 0.2rem 0 !important;
  font-weight: 600 !important;
  font-size: 1rem !important;
  border-left: 3px solid transparent !important;
  transition: all 0.3s ease !important;
  display: block !important;
  text-decoration: none !important;
}

/* Enlaces del TOC - NIVEL 2 */
#TOC ul ul li a,
.tocify-subheader a,
.list-group .list-group-item a {
  color: var(--light-ink) !important;
  background: transparent !important;
  border: none !important;
  padding: 0.6rem 1rem 0.6rem 1.8rem !important;
  margin: 0.1rem 0 !important;
  font-weight: 400 !important;
  font-size: 0.95rem !important;
  border-left: 2px solid transparent !important;
  transition: all 0.3s ease !important;
  display: block !important;
  text-decoration: none !important;
}

/* Enlaces del TOC - NIVEL 3 */
#TOC ul ul ul li a,
.tocify-subheader .tocify-subheader a {
  color: var(--light-ink) !important;
  background: transparent !important;
  border: none !important;
  padding: 0.5rem 1rem 0.5rem 2.6rem !important;
  margin: 0.1rem 0 !important;
  font-weight: 300 !important;
  font-size: 0.9rem !important;
  border-left: 1px solid transparent !important;
  transition: all 0.3s ease !important;
  display: block !important;
  text-decoration: none !important;
}

/* Hover para todos los niveles */
#TOC a:hover,
.tocify a:hover,
.list-group-item a:hover {
  color: var(--deep-ocean) !important;
  background: rgba(79, 176, 168, 0.08) !important;
  border-left: 3px solid var(--sea-glass) !important;
  transform: translateX(2px);
}

/* Active state */
#TOC a:active,
#TOC a:focus,
.tocify a:active,
.tocify a:focus,
.list-group-item.active a {
  color: var(--deep-ocean) !important;
  background: rgba(79, 176, 168, 0.12) !important;
  border-left: 3px solid var(--ocean-teal) !important;
  font-weight: 600 !important;
}

/* Listas anidadas */
#TOC ul ul,
.tocify-subheader,
.list-group .list-group {
  padding-left: 0.5rem !important;
  margin: 0 !important;
  border-left: 1px solid var(--border-light) !important;
}

/* T√≠tulo del TOC */
#TOC .toc-title,
.tocify-header:first-child {
  font-family: 'Merriweather', serif !important;
  font-size: 1.3rem !important;
  font-weight: 700 !important;
  color: var(--deep-ocean) !important;
  margin-bottom: 1rem !important;
  padding-bottom: 0.5rem !important;
  border-bottom: 2px solid var(--sea-glass) !important;
  text-align: center !important;
  background: transparent !important;
  border: none !important;
}
/* CONTENEDOR PRINCIPAL */
.container-fluid {
  background: linear-gradient(135deg, #F5FBFA 0%, var(--parchment) 100%);
  min-height: 100vh;
  padding: 1.5rem;
}

/* HEADER ACAD√âMICO */
.page-header {
  background: linear-gradient(135deg, var(--deep-ocean) 0%, var(--ocean-teal) 100%) !important;
  color: white;
  padding: 3.5rem 2rem !important;
  text-align: center;
  margin-bottom: 2.5rem !important;
  border-radius: 0;
  position: relative;
  overflow: hidden;
  border-bottom: 4px solid var(--sea-glass);
}

.page-header::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 60%);
}

.page-header h1 {
  color: white !important;
  font-size: 2.8rem;
  font-weight: 700;
  border: none;
  background: none;
  -webkit-text-fill-color: white;
  text-shadow: 0 1px 3px rgba(0,0,0,0.3);
  position: relative;
  z-index: 2;
  margin-bottom: 0.5rem;
}

.page-header h2 {
  color: rgba(255,255,255,0.95) !important;
  font-size: 1.4rem;
  font-weight: 300;
  border: none;
  background: none;
  font-family: 'Source Serif Pro', serif;
  position: relative;
  z-index: 2;
  margin-top: 0.5rem;
}

/* BLOQUES DE C√ìDIGO ACAD√âMICOS */
pre {
  background: #f8f9fa !important;
  color: var(--dark-ink) !important;
  padding: 1.2rem !important;
  border: 1px solid var(--border-light) !important;
  border-radius: 4px !important;
  border-left: 4px solid var(--ocean-teal) !important;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace !important;
  font-size: 0.85em;
  line-height: 1.5;
  margin: 1.2rem 0;
}

code {
  background: rgba(79, 176, 168, 0.1) !important;
  color: var(--ocean-teal) !important;
  padding: 0.15rem 0.4rem !important;
  border-radius: 3px;
  font-family: 'Consolas', 'Monaco', monospace !important;
  font-size: 0.8em;
  border: 1px solid rgba(79, 176, 168, 0.2);
}

/* TABLAS ACAD√âMICAS */
table {
  width: 100%;
  border-collapse: collapse;
  margin: 1.8rem 0;
  box-shadow: 0 1px 4px rgba(42, 95, 122, 0.08);
  border: 1px solid var(--border-light);
  border-radius: 4px;
  overflow: hidden;
  font-family: 'Lato', sans-serif;
}

th {
  background: linear-gradient(135deg, var(--ocean-teal), var(--deep-ocean)) !important;
  color: white !important;
  font-weight: 600;
  padding: 0.9rem !important;
  text-align: left;
  border: none !important;
  font-family: 'Lato', sans-serif;
  font-size: 0.9rem;
}

td {
  padding: 0.8rem !important;
  border: none !important;
  border-bottom: 1px solid var(--border-light) !important;
  font-size: 0.9rem;
}

tr:nth-child(even) {
  background: rgba(143, 212, 193, 0.05) !important;
}

tr:hover {
  background: rgba(79, 176, 168, 0.08) !important;
}

/* GR√ÅFICOS ACAD√âMICOS */
.plotly.html-widget {
  border-radius: 6px;
  box-shadow: 0 2px 8px rgba(42, 95, 122, 0.1);
  padding: 0.8rem;
  background: white;
  border: 1px solid var(--border-light);
  margin: 1.5rem 0;
}

/* BOTONES ACAD√âMICOS */
.btn {
  background: linear-gradient(135deg, var(--ocean-teal), var(--sea-glass)) !important;
  color: white !important;
  border: none !important;
  padding: 0.6rem 1.2rem !important;
  border-radius: 4px !important;
  font-weight: 500 !important;
  transition: all 0.2s ease !important;
  box-shadow: 0 1px 4px rgba(58, 142, 150, 0.3) !important;
  font-family: 'Lato', sans-serif !important;
}

.btn:hover {
  transform: translateY(-1px) !important;
  box-shadow: 0 2px 8px rgba(58, 142, 150, 0.4) !important;
}

/* FOOTER ACAD√âMICO */
.academic-footer {
  text-align: center;
  color: var(--ocean-teal);
  margin-top: 4rem;
  padding: 2.5rem 2rem;
  border-top: 2px solid var(--border-light);
  background: var(--mist);
  font-family: 'Merriweather', serif;
  font-size: 0.9rem;
}

/* CITAS Y BLOCKQUOTES */
blockquote {
  border-left: 4px solid var(--sea-glass);
  background: rgba(143, 212, 193, 0.05);
  padding: 1rem 1.5rem;
  margin: 1.5rem 0;
  font-style: italic;
  color: var(--light-ink);
  border-radius: 0 4px 4px 0;
}

/* LISTAS ACAD√âMICAS */
ul, ol {
  padding-left: 1.8rem;
  margin: 1.2rem 0;
}

li {
  margin: 0.5rem 0;
  line-height: 1.6;
}

/* RESPONSIVE DESIGN ACAD√âMICO */
@media (max-width: 768px) {
  .main-content {
    padding: 1.5rem;
    margin: 1rem;
    border-radius: 0;
  }
  
  h1 {
    font-size: 2rem;
  }
  
  h2 {
    font-size: 1.6rem;
    padding: 0.6rem 1rem;
  }
  
  .page-header {
    padding: 2.5rem 1rem !important;
  }
  
  .page-header h1 {
    font-size: 2rem;
  }
  
  #TOC {
    padding: 1.5rem 1rem !important;
    margin: 1.5rem 0 !important;
  }
}

/* ENLACES ACAD√âMICOS */
a {
  color: var(--ocean-teal);
  text-decoration: none;
  border-bottom: 1px solid transparent;
  transition: all 0.2s ease;
}

a:hover {
  color: var(--deep-ocean);
  border-bottom-color: var(--sea-glass);
}

/* SCROLLBAR DISCRETO */
::-webkit-scrollbar {
  width: 6px;
}

::-webkit-scrollbar-track {
  background: var(--mist);
}

::-webkit-scrollbar-thumb {
  background: var(--sea-glass);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--ocean-teal);
}

/* CONTROLES DE C√ìDIGO ACAD√âMICOS */
.code-toggle-container {
  text-align: center;
  margin: 3rem 0 2rem 0;
  padding: 2rem;
  background: linear-gradient(135deg, var(--mist) 0%, #F0F9F7 100%);
  border-radius: 8px;
  border: 1px solid var(--border-light);
  box-shadow: 0 2px 12px rgba(42, 95, 122, 0.08);
  border-left: 4px solid var(--ocean-teal);
}

.code-toggle-container h4 {
  margin-top: 0 !important;
  color: var(--deep-ocean) !important;
  font-family: 'Merriweather', serif !important;
  font-size: 1.3rem !important;
  border: none !important;
  background: none !important;
  padding: 0 !important;
}

.code-toggle-container p {
  color: var(--light-ink) !important;
  margin-bottom: 1.5rem !important;
  font-family: 'Source Serif Pro', serif !important;
  font-size: 0.95rem !important;
}

.code-toggle-btn {
  background: linear-gradient(135deg, var(--ocean-teal), var(--sea-glass));
  color: white !important;
  border: none;
  padding: 0.8rem 1.5rem;
  border-radius: 6px;
  font-family: 'Lato', sans-serif;
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 2px 8px rgba(58, 142, 150, 0.3);
  margin: 0 0.5rem 0.5rem 0;
}

.code-toggle-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(58, 142, 150, 0.4);
  background: linear-gradient(135deg, var(--sea-glass), var(--ocean-teal));
}

.code-toggle-btn.secondary {
  background: linear-gradient(135deg, var(--seafoam), var(--sea-glass));
  color: var(--dark-ink) !important;
}

.code-toggle-btn.secondary:hover {
  background: linear-gradient(135deg, var(--sea-glass), var(--seafoam));
}

/* BOT√ìN FLOTANTE GLOBAL */
.global-code-toggle {
  position: fixed;
  top: 20px;
  right: 20px;
  z-index: 10000;
  background: linear-gradient(135deg, var(--ocean-teal), var(--deep-ocean));
  color: white;
  border: none;
  padding: 0.8rem 1.2rem;
  border-radius: 25px;
  font-family: 'Lato', sans-serif;
  font-size: 0.85rem;
  font-weight: 600;
  cursor: pointer;
  box-shadow: 0 4px 20px rgba(42, 95, 122, 0.4);
  transition: all 0.3s ease;
}

.global-code-toggle:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 25px rgba(42, 95, 122, 0.6);
}

/* CONTENEDORES DE C√ìDIGO CON TOGGLE */
.code-chunk {
  margin: 2rem 0;
  border: 1px solid var(--border-light);
  border-radius: 6px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(42, 95, 122, 0.08);
  transition: all 0.3s ease;
}

.code-chunk:hover {
  box-shadow: 0 4px 15px rgba(42, 95, 122, 0.12);
}

.code-header {
  background: linear-gradient(135deg, var(--ocean-teal), var(--deep-ocean));
  color: white;
  padding: 1rem 1.5rem;
  display: flex;
  justify-content: space-between;
  align-items: center;
  cursor: pointer;
  transition: all 0.3s ease;
  font-family: 'Lato', sans-serif;
}

.code-header:hover {
  background: linear-gradient(135deg, var(--deep-ocean), var(--ocean-teal));
}

.chunk-title {
  font-family: 'Lato', sans-serif;
  font-weight: 600;
  font-size: 0.95rem;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.toggle-icon {
  font-family: 'Lato', sans-serif;
  font-weight: 700;
  font-size: 0.9rem;
  transition: transform 0.3s ease;
}

.toggle-icon.rotated {
  transform: rotate(180deg);
}

.code-content {
  background: #f8f9fa;
  transition: all 0.3s ease;
  overflow: hidden;
}

.code-content.collapsed {
  max-height: 0;
  opacity: 0;
  padding: 0;
}

.code-content.expanded {
  max-height: 5000px;
  opacity: 1;
  padding: 1rem;
}

/* INDICADOR DE ESTADO */
.code-status {
  display: inline-block;
  width: 8px;
  height: 8px;
  border-radius: 50%;
  margin-right: 8px;
}

.code-status.visible {
  background: #4CAF50;
  box-shadow: 0 0 5px #4CAF50;
}

.code-status.hidden {
  background: #FF9800;
  box-shadow: 0 0 5px #FF9800;
}

/* SMOOTH SCROLL Y NAVEGACI√ìN */
html {
  scroll-behavior: smooth;
}
"

writeLines(Valery_css, "Valery-styles.css")

```

```{js, echo=FALSE}
document.addEventListener('DOMContentLoaded', function() {
  // ELIMINADO: Smooth scroll que bloqueaba el TOC
  // El TOC de readthedown ya tiene su propio sistema de navegaci√≥n
  
  // Variable para controlar estado global
  let allCodeVisible = true;

  // Funci√≥n para crear controles individuales
  function initializeCodeToggles() {
    const codeChunks = document.querySelectorAll("pre.r, pre.python, pre.sourceCode");
    
    codeChunks.forEach((chunk, index) => {
      // Crear contenedor
      const container = document.createElement("div");
      container.className = "code-chunk";
      
      // Crear header
      const header = document.createElement("div");
      header.className = "code-header";
      
      // Obtener el lenguaje del c√≥digo
      const language = chunk.className.includes("r") ? "R" : 
                      chunk.className.includes("python") ? "Python" : "C√≥digo";
      
      header.innerHTML = `
        <div class="chunk-title">
          <span class="code-status visible"></span>
          ${language} - Chunk ${index + 1}
        </div>
        <div class="toggle-icon">‚ñº</div>
      `;
      
      // Crear contenido
      const content = document.createElement("div");
      content.className = "code-content expanded";
      content.appendChild(chunk.cloneNode(true));
      
      // Reemplazar el chunk original
      chunk.parentNode.replaceChild(container, chunk);
      container.appendChild(header);
      container.appendChild(content);
      
      // Agregar evento de click
      header.addEventListener("click", function() {
        const isExpanded = content.classList.contains("expanded");
        const icon = this.querySelector(".toggle-icon");
        const status = this.querySelector(".code-status");
        
        if (isExpanded) {
          content.classList.remove("expanded");
          content.classList.add("collapsed");
          icon.classList.add("rotated");
          status.classList.remove("visible");
          status.classList.add("hidden");
        } else {
          content.classList.remove("collapsed");
          content.classList.add("expanded");
          icon.classList.remove("rotated");
          status.classList.remove("hidden");
          status.classList.add("visible");
        }
      });
    });
  }

  // Funci√≥n para toggle global
  function toggleAllCode() {
    const codeContents = document.querySelectorAll(".code-content");
    const headers = document.querySelectorAll(".code-header");
    const globalToggle = document.querySelector(".global-code-toggle");
    
    if (allCodeVisible) {
      // Ocultar todo
      codeContents.forEach(content => {
        content.classList.remove("expanded");
        content.classList.add("collapsed");
      });
      headers.forEach(header => {
        const icon = header.querySelector(".toggle-icon");
        const status = header.querySelector(".code-status");
        if (icon) icon.classList.add("rotated");
        if (status) {
          status.classList.remove("visible");
          status.classList.add("hidden");
        }
      });
      if (globalToggle) globalToggle.innerHTML = "üîß Mostrar C√≥digo";
      allCodeVisible = false;
    } else {
      // Mostrar todo
      codeContents.forEach(content => {
        content.classList.remove("collapsed");
        content.classList.add("expanded");
      });
      headers.forEach(header => {
        const icon = header.querySelector(".toggle-icon");
        const status = header.querySelector(".code-status");
        if (icon) icon.classList.remove("rotated");
        if (status) {
          status.classList.remove("hidden");
          status.classList.add("visible");
        }
      });
      if (globalToggle) globalToggle.innerHTML = "üîß Ocultar C√≥digo";
      allCodeVisible = true;
    }
  }

  // Inicializar toggles individuales
  initializeCodeToggles();

  // Crear bot√≥n flotante (no interfiere con el TOC)
  const globalToggle = document.createElement("button");
  globalToggle.className = "global-code-toggle";
  globalToggle.innerHTML = "üîß Ocultar C√≥digo";
  document.body.appendChild(globalToggle);
  
  // Evento para el bot√≥n global
  globalToggle.addEventListener("click", toggleAllCode);

  // Funciones globales para uso externo si se necesitan
  window.toggleAllCode = toggleAllCode;
  
  window.expandAllCode = function() {
    const codeContents = document.querySelectorAll(".code-content");
    const headers = document.querySelectorAll(".code-header");
    const globalToggle = document.querySelector(".global-code-toggle");
    
    codeContents.forEach(content => {
      content.classList.remove("collapsed");
      content.classList.add("expanded");
    });
    headers.forEach(header => {
      const icon = header.querySelector(".toggle-icon");
      const status = header.querySelector(".code-status");
      if (icon) icon.classList.remove("rotated");
      if (status) {
        status.classList.remove("hidden");
        status.classList.add("visible");
      }
    });
    if (globalToggle) globalToggle.innerHTML = "üîß Ocultar C√≥digo";
    allCodeVisible = true;
  };

  window.collapseAllCode = function() {
    const codeContents = document.querySelectorAll(".code-content");
    const headers = document.querySelectorAll(".code-header");
    const globalToggle = document.querySelector(".global-code-toggle");
    
    codeContents.forEach(content => {
      content.classList.remove("expanded");
      content.classList.add("collapsed");
    });
    headers.forEach(header => {
      const icon = header.querySelector(".toggle-icon");
      const status = header.querySelector(".code-status");
      if (icon) icon.classList.add("rotated");
      if (status) {
        status.classList.remove("visible");
        status.classList.add("hidden");
      }
    });
    if (globalToggle) globalToggle.innerHTML = "üîß Mostrar C√≥digo";
    allCodeVisible = false;
  };
});
```

::: abstract
**Resumen** : *Este estudio analiza los determinantes de las ventas en micronegocios de la regi√≥n Caribe colombiana mediante regresi√≥n lineal m√∫ltiple. Se utilizaron datos de la Encuesta de Micronegocios (EMICRON) 2022 del DANE, con una muestra de 2.020 observaciones de siete departamentos caribe√±os.*

*El modelo identifica como variables explicativas significativas los gastos operativos, valor agregado, inversi√≥n en activos y arrendamiento, adem√°s de efectos diferenciados por departamento. Los resultados muestran que los gastos operativos son el principal determinante de las ventas, seguido por el valor agregado generado.*

*El modelo presenta un poder explicativo robusto y significancia estad√≠stica global. Los supuestos de regresi√≥n se cumplen de manera aceptable para datos econ√≥micos reales, con ligeras desviaciones que no comprometen la validez pr√°ctica del an√°lisis.*

*Las predicciones generadas permiten evaluar diferentes escenarios operativos y confirman que la eficiencia en el uso del capital de trabajo es m√°s determinante que la capitalizaci√≥n en activos fijos para el √©xito comercial de los micronegocios en la regi√≥n estudiada.*
:::

# Introducci√≥n

::: content-block
El peso al nacer es uno de los determinantes m√°s importantes del bienestar con el que un ser humano inicia su vida. Es un indicador de morbilidad y mortalidad pedi√°trica y neonatal, as√≠ como un antecedente clave en las diferencias del desarrollo cognitivo y de las enfermedades cr√≥nicas en etapas posteriores. Sin embargo, tambi√©n representa una problem√°tica multifactorial en la que intervienen diversas fallas sociales, como la desigualdad econ√≥mica, el acceso a la salud, las condiciones de vida y la educaci√≥n en salud materno-infantil. Todo esto genera brechas en las propiedades intelectuales y materiales durante una etapa tan vital y cr√≠tica como el desarrollo √≥ptimo de los nacidos vivos del pa√≠s, lo que produce impactos en los niveles de natalidad, el desarrollo de ni√±os y adolescentes, y en las madres presentes y futuras.

Un reci√©n nacido con bajo peso y/o desnutrici√≥n no solo refleja una falta de responsabilidad materna hacia su hijo, sino tambi√©n las brechas que impiden que las madres accedan a un seguimiento adecuado y controlado de su embarazo. Esto les dificulta vivir este proceso de manera tranquila y exitosa, y hace que sus hijos no inicien sus primeros momentos de vida de forma satisfactoria.

Como se mencion√≥ anteriormente, el desarrollo prenatal del beb√© representa uno de los factores m√°s influyentes desde el punto de vista social, ya que engloba y describe las condiciones del entorno en el que nace el individuo y en el que probablemente transitara las etapas futuras de su desarrollo. Lo anterior se resume en las particularidades del embarazo de las madres de los reci√©n nacidos vivos. Estos aspectos se abordar√°n en el desarrollo de la presente investigaci√≥n, puesto que desde el √°rea de la ingenier√≠a es posible realizar una prospectiva de la situaci√≥n, facilitando la formulaci√≥n de soluciones desde un enfoque social.

A pesar de que los antecedentes corresponden a una problem√°tica nacional, Bogot√°, a pesar de ser la capital del pa√≠s y contar con un mejor desarrollo regional, no est√° exenta de ella. Seg√∫n datos del DANE, el 17% de los casos de desnutrici√≥n neonatal del segundo semestre del a√±o 2024 corresponden a esta ciudad.

El presente estudio emplea modelos de clasificaci√≥n supervisada (regresi√≥n log√≠stica y KNN) utilizando los datos de nacimientos vivos en Bogot√°, con el objetivo de analizar la relaci√≥n entre la desnutrici√≥n neonatal y un conjunto de variables explicativas. Entre estas, se consideran el tiempo de gestaci√≥n, el tipo de parto, el n√∫mero de controles prenatales, la edad materna y el n√∫mero de embarazos previos. La selecci√≥n de estas variables se fundamenta tanto en la revisi√≥n de literatura cient√≠fica relevante como en las caracter√≠sticas sociodemogr√°ficas y sanitarias propias del contexto bogotano, las cuales han sido identificadas en informes nacionales y estudios previos como factores determinantes en el estado nutricional al nacer.
:::

# Descripci√≥n de la fuente de datos

::: content-block
**Base de datos:** Encuesta de estad√≠sticas vitales - EEVV - 2024

**Unidad de an√°lisis:** Nacimiento

**Per√≠odo:** (2024)

**Acceso:** [https://microdatos.dane.gov.co/index.php/catalog/878](https://microdatos.dane.gov.co/index.php/catalog/878/data-dictionary/F46?file_name=BD-EEVV-Nacimientos-2024){.uri}

Los datos utilizados en esta investigaci√≥n provienen de la Encuesta de Estad√≠sticas Vitales (EEVV) 2024 del Departamento Administrativo Nacional de Estad√≠stica (DANE). Esta encuesta administra el registro administrativo de nacimientos en Colombia y recoge informaci√≥n detallada sobre caracter√≠sticas demogr√°ficas, sociales y cl√≠nicas relacionadas con el reci√©n nacido y su madre.
:::

# Metodolog√≠a

::: content-block
La metodolog√≠a de esta investigaci√≥n se basa en la aplicaci√≥n de dos modelos de clasificaci√≥n supervisada, K-Nearest Neighbors (KNN) y Regresi√≥n Log√≠stica, con el objetivo de identificar y analizar las fallas sociales y estructurales que inciden en la desnutrici√≥n neonatal en Bogot√° durante el segundo semestre de 2024. Estos modelos permiten determinar la influencia de variables sociales, econ√≥micas y de salud en este problema de salud p√∫blica, tomando como indicador principal la desnutrici√≥n al nacer.

La selecci√≥n de variables incluye aspectos educativos, econ√≥micos y estructurales que reflejan el control social desde la concepci√≥n hasta el nacimiento, as√≠ como par√°metros cl√≠nicos relevantes. Esto garantiza un an√°lisis integral de los determinantes del estado nutricional neonatal.

El estudio utiliza una base de datos representativa y actualizada proveniente de la Encuesta de Estad√≠sticas Vitales (EEVV) 2024 del DANE, focalizando su an√°lisis en la poblaci√≥n nacida en Bogot√° durante ese periodo.

## Procesamiento de datos

Inicialmente, la base de datos conten√≠a 34,424 registros de nacidos vivos. Como primer paso, se realiz√≥ una limpieza rigurosa:

-   Se eliminaron observaciones con valores faltantes o inconsistentes en todas las variables clave.

-   Se dividi√≥ la base en dos sub-bases: reci√©n nacidos con desnutrici√≥n (‚ÄúS√≠‚Äù) y sin desnutrici√≥n (‚ÄúNo‚Äù), con base en la variable dependiente principal.

-   Para evitar sesgo por desbalance de clases, se aplic√≥ un procedimiento de balanceo, lo que permiti√≥ construir una muestra final equilibrada de 11,872 observaciones.

## Variables analizadas

El modelo incorpora variables seleccionadas por su relevancia emp√≠rica documentada en la literatura cient√≠fica y en lineamientos oficiales:

-   Tiempo de gestaci√≥n (en rangos de meses)

-   Tipo de parto (Cesaria, Espontaneo o instrumentado)

-   N√∫mero de controles prenatales recibidos durante el embarazo

-   Edad de la madre (en rangos categ√≥ricos)

-   N√∫mero de embarazos previos

```{r tabla_variables}
# TABLA DE VARIABLES DEL MODELO
variables_modelo <- data.frame(
  Variable = c("Peso", "Tiempo gestaci√≥n", "Tipo parto", 
               "Numero control prenatal", "Edad madre", "Numero embarazos"),
  Descripci√≥n = c("Clasificaci√≥n del peso al nacer (Normal/Delicado)",
                 "Semanas de gestaci√≥n", 
                 "Tipo de parto registrado",
                 "N√∫mero de controles prenatales realizados",
                 "Grupo etario de la madre",
                 "N√∫mero de embarazos previos"),
  Tipo_Variable = c("Categ√≥rica (binaria)", "Categ√≥rica ordinal", 
                   "Categ√≥rica nominal", "Cuantitativa discreta",
                   "Categ√≥rica ordinal", "Cuantitativa discreta"),
  Notas = c("Variable dependiente - Peso normal: ‚â•2500g", 
           "Considerar <37 semanas como prematurez",
           "Espont√°neo/Ces√°rea/Instrumentado",
           "Indicador de acceso a salud prenatal",
           "Recodificado a 9 rangos etarios (C√≥digos 1 a 9)",
           "Incluye embarazo actual")
)

kable(variables_modelo, 
      caption = "Tabla 1: Variables del Modelo",
      align = c("l", "l", "l", "l"),
      col.names = c("Variable", "Descripci√≥n", "Tipo de Variable", "Notas")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE,
                font_size = 12) %>%
  row_spec(0, background = "#2C3E50", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "12em") %>%
  footnote(general = "Fuente: Elaboraci√≥n propia en base a la Base de Datos de Nacimientos - 2024",
           number = c("Datos corresponden al segundo semestre del a√±o 2024"))
```

```{r cargar_datos, include=FALSE}
# Configuraci√≥n inicial - manteniendo tu c√≥digo base
BD_EEVV <- read_csv("BD-EEVV-Nacimientos-2024.csv") %>%
  select(COD_DPTO, PESO_NAC, T_GES, TIPO_PARTO, NUMCONSUL, EDAD_MADRE, N_EMB, MES) %>%
  rename(
    Departamento = COD_DPTO,
    Peso_delicado = PESO_NAC,
    Tiempo_gestaci√≥n = T_GES,
    Tipo_parto = TIPO_PARTO,
    Numero_control_prenatal = NUMCONSUL,
    Edad_madre = EDAD_MADRE,
    Numero_embarazos = N_EMB,
    Mes = MES
  ) %>%
  mutate(
    Numero_control_prenatal = as.numeric(Numero_control_prenatal),
    Numero_embarazos = as.numeric(Numero_embarazos),
    Tiempo_gestaci√≥n = factor(Tiempo_gestaci√≥n,
                              levels = c(1, 2, 3, 4, 5),
                              labels = c("22 o menos semanas", "22-27 semanas", "28-37 semanas",
                                         "38-41 semanas", "42 o m√°s semanas"))
  ) %>%
  mutate(
    Peso_delicado = ifelse(Peso_delicado %in% c(5, 6, 7, 8, 9), "No", "Si"),
    Peso_delicado = factor(Peso_delicado, levels = c("Si", "No"))
  ) %>%
  mutate(Mes = as.numeric(Mes)) %>%
  filter(Mes %in% c(7, 8, 9, 10, 11, 12)) %>%
  filter(Departamento == 11) %>%
  mutate(Departamento = "Bogot√°") %>%
  na.omit()
```

```{r balanceo_datos, include=FALSE}
# Balanceo
set.seed(5)
Si <- BD_EEVV %>% filter(Peso_delicado == "Si")
No <- BD_EEVV %>% filter(Peso_delicado == "No") %>% sample_n(6000)

# Base final
Base_datos <- bind_rows(Si, No) %>%
  select(Tiempo_gestaci√≥n, Tipo_parto, Numero_control_prenatal,
         Edad_madre, Numero_embarazos, Peso_delicado) %>%
  mutate(
    Tipo_parto = case_when(
      Tipo_parto == 1 ~ "Espontaneo",
      Tipo_parto == 2 ~ "Cesarea",
      Tipo_parto == 3 ~ "Instrumentado"
    ),
    Edad_madre = case_when(
      Edad_madre == 1 ~ "10-14 a√±os",
      Edad_madre == 2 ~ "15-19 a√±os",
      Edad_madre == 3 ~ "20-24 a√±os",
      Edad_madre == 4 ~ "25-29 a√±os",
      Edad_madre == 5 ~ "30-34 a√±os",
      Edad_madre == 6 ~ "35-39 a√±os",
      Edad_madre == 7 ~ "40-44 a√±os",
      Edad_madre == 8 ~ "45-49 a√±os",
      Edad_madre == 9 ~ "50-54 a√±os"
    ),
    Tipo_parto = as.factor(Tipo_parto),
    Edad_madre = as.factor(Edad_madre)
  ) %>%
  filter(complete.cases(.))
```

Estas variables reflejan tanto el entorno social y estructural como el acceso a servicios de salud y el historial reproductivo, permitiendo un an√°lisis integral de los riesgos de desnutrici√≥n neonatal.

## Justificaci√≥n de la selecci√≥n de variables dependiente e independientes

La variable dependiente seleccionada es el estado nutricional del reci√©n nacido al momento del nacimiento, el cual se clasifica en dos categor√≠as: ‚ÄúS√≠‚Äù (el beb√© presenta desnutrici√≥n al nacer) y ‚ÄúNo‚Äù (el beb√© no presenta desnutrici√≥n al nacer). Esta variable permite identificar los factores asociados a la desnutrici√≥n neonatal, la cual est√° asociada a mayores riesgos de morbilidad y mortalidad infantil, y es reconocida como un indicador cr√≠tico por la Organizaci√≥n Mundial de la Salud (OMS, 2017; DANE, 2024). La desnutrici√≥n al nacer refleja desigualdades en acceso a servicios de salud prenatal, nutrici√≥n materna, condiciones sociales y caracter√≠sticas biol√≥gicas de la gestaci√≥n, y es adem√°s un predictor del desarrollo f√≠sico y cognitivo del ni√±o (OMS, 2017; DANE, 2024).

Entre las variables independientes, se escogieron aquellas que, seg√∫n reportes oficiales y estudios previos, tienen una relaci√≥n directa con el peso al nacer.

-   **Tiempo de gestaci√≥n (semanas) :** Es fundamental ya que la prematurez est√° asociada con un peso menor al esperado. Nacimientos antes de las 37 semanas suelen presentar bajo peso debido a la inmadurez fetal (DANE, 2024). Estudios confirman que el tiempo de gestaci√≥n es el principal determinante biol√≥gico del peso neonatal (Wu et al., 2022; Kramer, 1987).

-   **El tipo de parto (espont√°neo, ces√°rea o instrumentado)** indica las caracter√≠sticas m√©dicas de la gestaci√≥n y el nacimiento. Partos por ces√°rea e instrumentados est√°n frecuentemente relacionados con complicaciones que pueden influir en el peso del reci√©n nacido (DANE, 2024).

-   **La cantidad de consultas prenatales:** ¬†constituye un indicador fundamental de acceso y calidad en la atenci√≥n materna. Estudios del Instituto Nacional de Salud (2020) muestran mayor riesgo de bajo peso en madres con menos de cuatro controles, lo que evidencia la importancia del diagn√≥stico temprano de complicaciones, suplementaci√≥n nutricional y seguimiento del desarrollo fetal.

<!-- -->

-   **La edad de la madre (a√±os)**: Se considera porque las madres adolescentes y las de mayor edad tienen tasas m√°s elevadas de bajo peso al nacer, conforme a las estad√≠sticas en Colombia (Instituto Nacional de Salud, 2020). Estas poblaciones pueden presentar mayores riesgos biol√≥gicos y sociales asociados.

<!-- -->

-   **N√∫mero de embarazos previos:** Influye en la capacidad reproductiva y salud materna. El historial de embarazos m√∫ltiples puede afectar la nutrici√≥n y el ambiente uterino, lo cual impacta el peso del reci√©n nacido

Estas variables fueron elegidas considerando evidencia emp√≠rica documentada, garantizando una base s√≥lida para un modelo predictivo que permita comprender y analizar factores asociados al peso al nacer en Bogot√°, con miras a fortalecer pol√≠ticas p√∫blicas de salud materno-infantil y mejorar indicadores en Colombia.

## Descripci√≥n del modelo de regresi√≥n lineal m√∫ltiple

Los datos empleados se obtuvieron de la p√°gina de microdatos y metadatos del DANE, utilizando la Encuesta Vital correspondiente al a√±o 2024 de la secci√≥n de nacimientos. Se realiz√≥ una serie de modificaciones para lograr una mejor proporci√≥n y comprensi√≥n de los datos: la base fue filtrada no solo por la selecci√≥n de variables, sino tambi√©n por la distribuci√≥n de frecuencias del umbral empleado (bajo peso al nacer), focalizando as√≠ la informaci√≥n correspondiente a los nacimientos en la ciudad de Bogot√° durante el segundo semestre del a√±o en que se realiz√≥ la encuesta.

El motivo de la filtraci√≥n exhaustiva fue lograr una mayor homogeneidad en los datos, fundamental para sustentar la hip√≥tesis principal: respaldar, a trav√©s de la evidencia, los determinantes sociales que inciden en los √≠ndices de desnutrici√≥n en el territorio. Dada la magnitud y extensi√≥n de la base de datos original, se tom√≥ la decisi√≥n de acotarla para obtener resultados esperados aplicando dos tipos de modelos de aprendizaje supervisados, cuyo objetivo es clasificar de manera binaria una serie de caracter√≠sticas de la poblaci√≥n.

Los modelos corresponden a:

1.  **K- nearest neighbors.**

Este modelo busca clasificar en dos sentencias¬† una serie de predicciones basadas en caracter√≠sticas que tienen las dos sentencias, es decir, clasificar mediante predicciones de las caracter√≠sticas en las sentencias que tienen caracteristicas cercanas, de ah√≠ su nombre. "k" representa la cantidad de vecinos m√°s cercanos considerados en el problema de clasificaci√≥n o regresi√≥n, y "NN" se refiere a los vecinos m√°s cercanos a la cantidad elegida para k.¬†

En el problema con el que se est√° trabajando las caracteristicas que se tienen son las variables independientes y las sentencias son la variable dependiente que solo puede clasificar en dos opciones debido a la dicotom√≠a de la variable. El umbral empleado tiene como palabras de clasificaci√≥n si o no (si tiene bajo peso, no tiene bajo peso (peso moderado)).

Con este modelo se busca indagar, la veracidad de las variables independientes como sintomas en una sentencia, es decir, si las variables seleccionadas abarcan las caracteristicas suficientes para dictaminar una sentencia congruente.

2.  **Regresi√≥n logistica.**

La regresion logistica es un modelo de predicci√≥n que a diferencia de un modelo de regresi√≥n lineal, que busca predecir la influencia de multiples variables independientes sobre una variable dependiente numerica, este por el contrario busca predecir la probabilidad de clasificar una serie de variables independientes sobre una variable dependiente binaria que encasilla 2 sentencias, basadas en el aprendizaje de un modelo en el cual se tiene conocimiento de los resultados.

Teniendo en consideraci√≥n, la problematica que se est√° modelando, los objetivos que se estiman es tener una probabilidad de clasificaci√≥n que sea consecuente con el modelo anterior, con el fin de formular conclusiones veridicas y posteriormente soluciones a la problem√°tica.

## Base de datos del estudio

Para este trabajo se emplea la base de datos de la Encuesta de Estad√≠sticas Vitales (EEVV) 2024 del DANE, filtrada espec√≠ficamente para el periodo del segundo semestre en la ciudad de Bogot√°. El conjunto de datos fue depurado rigurosamente para incluir √∫nicamente las observaciones completas y las variables relevantes para los modelos de clasificaci√≥n KNN y Regresi√≥n Log√≠stica, asegurando as√≠ la calidad y pertinencia de la muestra seleccionada para el an√°lisis.

```{r tabla_interactiva,}
# TABLA INTERACTIVA FINAL
library(htmltools)
reactable(
  Base_datos,
  defaultPageSize = 15,
  showPageSizeOptions = TRUE,
  pageSizeOptions = c(10, 15, 25, 50, 100),
  filterable = TRUE,
  searchable = TRUE,
  sortable = TRUE,
  resizable = TRUE,
  striped = TRUE,
  highlight = TRUE,
  bordered = FALSE,
  wrap = FALSE,
  showSortable = TRUE,
  defaultColDef = colDef(
    header = function(value) {
      name <- gsub("_", " ", value)
      name <- gsub("([a-z])([A-Z])", "\\1 \\2", name)
      tools::toTitleCase(tolower(name))
    },
    cell = function(value) {
      if (is.numeric(value)) {
        if (value == round(value)) {
          format(value, big.mark = ",", scientific = FALSE)
        } else {
          format(round(value, 2), nsmall = 2, big.mark = ",", scientific = FALSE)
        }
      } else {
        as.character(value)
      }
    },
    align = "center",
    minWidth = 100,
    headerStyle = list(
      background = "#2C3E50",
      color = "white",
      fontWeight = "600",
      borderBottom = "2px solid #dee2e6",
      fontSize = "13px"
    ),
    style = list(
      fontSize = "12px",
      fontFamily = "Arial, sans-serif"
    )
  ),
  style = list(
    fontFamily = "Arial, sans-serif",
    fontSize = "13px"
  ),
  theme = reactableTheme(
    stripedColor = "#f8f9fa",
    highlightColor = "#e9ecef",
    cellPadding = "8px 12px",
    backgroundColor = "#ffffff",
    borderColor = "#dee2e6",
    style = list(
      fontFamily = "Arial, -apple-system, BlinkMacSystemFont, sans-serif"
    ),
    searchInputStyle = list(
      width = "100%",
      padding = "8px 12px",
      border = "1px solid #ced4da",
      borderRadius = "4px",
      fontSize = "14px",
      marginBottom = "10px"
    ),
    headerStyle = list(
      borderBottom = "2px solid #495057",
      fontSize = "14px",
      backgroundColor = "#2C3E50",
      color = "white"
    )
  ),
  columns = list(
    Tiempo_gestaci√≥n = colDef(
      name = "Tiempo Gestaci√≥n",
      minWidth = 180,
      filterable = TRUE,
      align = "left"
    ),
    Edad_madre = colDef(
      name = "Edad Madre", 
      minWidth = 120,
      filterable = TRUE
    ),
    Peso_delicado = colDef(
      name = "Peso Delicado",
      style = function(value) {
        color <- ifelse(value == "Si", "#E74C3C", "#27AE60")
        list(fontWeight = "bold", color = color)
      }
      
    )
  )
)

```
:::

# Resultados Descriptivos

:::: content-block
A continuaci√≥n se presentan las estad√≠sticas descriptivas, que resumen las caracter√≠sticas principales de la muestra estudiada. Este an√°lisis preliminar permite conocer la distribuci√≥n, tendencia central y dispersi√≥n de las variables clave, facilitando la comprensi√≥n del contexto y estableciendo la base para an√°lisis posteriores.

Las estad√≠sticas descriptivas son fundamentales para identificar patrones y diferencias entre grupos, que apoyan la validaci√≥n de los modelos predictivos empleados en el estudio.

## Estad√≠sticas descriptivas de las variables seleccionadas

::: content-block
### **Analisis de la Variable Dependiente: Desnutrici√≥n Neonatal**

Los resultados obtenidos a partir del an√°lisis descriptivo del peso de los nacimientos en Bogot√° durante el segundo semestre de 2024 se resumen en la Tabla 1. Estos resultados permiten identificar diferencias clave entre los grupos de reci√©n nacidos con peso delicado¬† ‚ÄúSi‚Äù y ‚ÄúNo‚Äù.¬† Ambas categor√≠as est√°n equilibradas, lo que permite un an√°lisis comparativo robusto.¬†

```{r tabla1_1_tamano_muestral}
# TABLA 1.1: TAMA√ëO MUESTRAL POR GRUPO DE PESO
tabla_1_1 <- Base_datos %>%
  group_by(Peso_delicado) %>%
  summarise(
    n = n(),
    Porcentaje = round(100 * n() / nrow(Base_datos), 1)
  )

kable(tabla_1_1, 
      align = c("l", "r", "r"),
      format.args = list(big.mark = ",", decimal.mark = "."),
      col.names = c("Peso Delicado", "N", "%"),
      caption = "TABLA 1.1. TAMA√ëO MUESTRAL POR GRUPO DE PESO AL NACER") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover"),
    full_width = FALSE,
    font_size = 12,
    position = "center"
  ) %>%
  add_header_above(c(" " = 1, "Tama√±o Muestral" = 2),
                   background = "#2C3E50", color = "white") %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "12em") %>%
  column_spec(2:3, background = "#F4F6F6") %>%
  footnote(
    general = "Fuente: Elaboraci√≥n propia con base en la Encuesta de Nacimientos ‚Äì DANE 2024.",
    number = c("Datos corresponden a nacimientos en Bogot√° (julio-diciembre 2024)")
  )
```

La tabla muestra que el grupo de reci√©n nacidos con desnutrici√≥n neonatal (‚ÄúS√≠‚Äù) representa el 49.5% de la muestra, mientras que el grupo ‚ÄúNo‚Äù alcanza el 50.5%. Esto indica una distribuci√≥n muy equilibrada entre ambos grupos lo que permite llevar a cabo an√°lisis comparativos robustos y sin sesgos por desproporci√≥n entre categor√≠as.

Adem√°s, se realiz√≥ un an√°lisis descriptivo de la variable dependiente en relaci√≥n con las dos variables independientes cuantitativas del estudio, para identificar diferencias y tendencias principales entre los grupos.

**Analisis del grupo de peso en relacion con los controles prenatales**

```{r tabla1_2_controles_prenatales}
# TABLA 1.2: CONTROLES PRENATALES POR GRUPO DE PESO
tabla_1_2 <- Base_datos %>%
  group_by(Peso_delicado) %>%
  summarise(
    Media = round(mean(Numero_control_prenatal, na.rm = TRUE), 1),
    DE = round(sd(Numero_control_prenatal, na.rm = TRUE), 1),
    Min = min(Numero_control_prenatal, na.rm = TRUE),
    Max = max(Numero_control_prenatal, na.rm = TRUE)
  )

kable(tabla_1_2, 
      align = c("l", "r", "r", "r", "r"),
      format.args = list(big.mark = ",", decimal.mark = "."),
      col.names = c("Peso Delicado", "Media", "DE", "M√≠n", "M√°x"),
      caption = "TABLA 1.2. CONTROLES PRENATALES POR GRUPO DE PESO AL NACER") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover"),
    full_width = FALSE,
    font_size = 12,
    position = "center"
  ) %>%
  add_header_above(c(" " = 1, "Controles Prenatales" = 4),
                   background = "#2C3E50", color = "white") %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "12em") %>%
  column_spec(2:5, background = "#E8F8F5") %>%
  footnote(
    general = "Fuente: Elaboraci√≥n propia con base en la Encuesta de Nacimientos ‚Äì DANE 2024.",
    number = c("Datos corresponden a nacimientos en Bogot√° (julio-diciembre 2024)")
  )
```

El grupo de nacidos desnutridos registra un promedio de 6.6 controles, por debajo de los 7.2 en el grupo de los que no. Esto respalda estudios que se√±alan menor acceso a controles prenatales como factor de riesgo de bajo peso al nacer

**Analisis del grupo de peso en relacion con el numero de embarazos**

```{r tabla1_3_numero_embarazos}
# TABLA 1.3: N√öMERO DE EMBARAZOS POR GRUPO DE PESO
tabla_1_3 <- Base_datos %>%
  group_by(Peso_delicado) %>%
  summarise(
    Media = round(mean(Numero_embarazos, na.rm = TRUE), 1),
    DE = round(sd(Numero_embarazos, na.rm = TRUE), 1),
    Min = min(Numero_embarazos, na.rm = TRUE),
    Max = max(Numero_embarazos, na.rm = TRUE)
  )

kable(tabla_1_3, 
      align = c("l", "r", "r", "r", "r"),
      format.args = list(big.mark = ",", decimal.mark = "."),
      col.names = c("Peso Delicado", "Media", "DE", "M√≠n", "M√°x"),
      caption = "TABLA 1.3. N√öMERO DE EMBARAZOS POR GRUPO DE PESO AL NACER") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover"),
    full_width = FALSE,
    font_size = 12,
    position = "center"
  ) %>%
  add_header_above(c(" " = 1, "N√∫mero de Embarazos" = 4),
                   background = "#2C3E50", color = "white") %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "12em") %>%
  column_spec(2:5, background = "#FEF5E7") %>%
  footnote(
    general = "Fuente: Elaboraci√≥n propia con base en la Encuesta de Nacimientos ‚Äì DANE 2024.",
    number = c("Datos corresponden a nacimientos en Bogot√° (julio-diciembre 2024)")
  )
```

Ambos grupos presentan el mismo promedio de 1.9 embarazos previos, sugiriendo que en esta muestra particular este factor no distingue entre los dos grupos.

### **Analisis de la Variable Independiente:** Tiempo De Gestaci√≥n

La distribuci√≥n del tiempo de gestacion en la muestra se presenta en la Tabla \_\_\_.¬†

```{r tabla2_tiempo_gestacion}
# TABLA 2: DISTRIBUCI√ìN DEL TIEMPO DE GESTACI√ìN
tabla_tiempo_gestacion <- Base_datos %>%
  count(Tiempo_gestaci√≥n) %>%
  mutate(
    Porcentaje = round(100 * n / sum(n), 1),
    Porcentaje_Acumulado = cumsum(Porcentaje)
  )

kable(tabla_tiempo_gestacion, 
      align = c("l", "c", "r", "r"),
      col.names = c("Tiempo de Gestaci√≥n", "Frecuencia", "Porcentaje (%)", "Porcentaje Acumulado (%)"),
      caption = "TABLA 2. DISTRIBUCI√ìN DEL TIEMPO DE GESTACI√ìN") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = FALSE,
    font_size = 12
  ) %>%
  add_header_above(c(" " = 1, "Distribuci√≥n de Frecuencias" = 3),
                   background = "#2C3E50", color = "white") %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "20em") %>%
  column_spec(2:4, background = "#F4F6F6") %>%
  footnote(
    general = "Fuente: Elaboraci√≥n propia con base en la Encuesta de Nacimientos ‚Äì DANE 2024."
  )
```

La tabla muestra la distribuci√≥n del tiempo de gestaci√≥n en la muestra analizada. La mayor√≠a de los nacimientos se concentra entre 28 y 37 semanas (53.2%), seguidos de los partos entre 38 y 41 semanas (45.5%). Los nacimientos antes de las 28 semanas representan solo el 1.3%, mientras que los partos de 42 o m√°s semanas son extremadamente infrecuentes (1 caso). Esto indica que la mayor parte de los nacimientos ocurre dentro de rangos aceptados como "a t√©rmino" o moderadamente prematuros, con muy pocos casos en los extremos.

Para analizar c√≥mo el tiempo de gestaci√≥n se relaciona con la variable dependiente de desnutrici√≥n neonatal, se utiliza un gr√°fico de barras apiladas. Este tipo de visualizaci√≥n permite observar de forma clara la distribuci√≥n y el comportamiento de ambos grupos, facilitando la identificaci√≥n de patrones y posibles asociaciones relevantes para el estudio.

```{r grafico2_tiempo_vs_peso, fig.width=8, fig.height=5}
# GR√ÅFICO 2: RELACI√ìN TIEMPO DE GESTACI√ìN VS PESO DELICADO (BARRAS APILADAS)
tabla_tiempo_peso <- Base_datos %>%
  count(Tiempo_gestaci√≥n, Peso_delicado)

plot_ly(
  tabla_tiempo_peso,
  x = ~Tiempo_gestaci√≥n,
  y = ~n,
  color = ~Peso_delicado,
  colors = c('#27AE60', '#E74C3C'),  # Verde para No, Rojo para Si
  type = 'bar',
  text = ~n,
  textposition = 'inside',
  hovertemplate = paste(
    '<b>%{x}</b><br>',
    'Peso Delicado: %{fullData.name}<br>',
    'Frecuencia: %{y}<br>',
    '<extra></extra>'
  )
) %>%
  plotly::layout(
    barmode = 'stack',
    title = list(
      text = "<b>Gr√°fico 2. Tiempo de Gestaci√≥n seg√∫n Peso Delicado</b><br><sub>Bogot√° - Segundo Semestre 2024</sub>",
      x = 0.5,
      font = list(size = 16)
    ),
    xaxis = list(
      title = "<b>Tiempo de Gestaci√≥n</b>",
      tickfont = list(size = 10)
    ),
    yaxis = list(
      title = "<b>Frecuencia</b>"
    ),
    legend = list(
      title = list(text = "<b>Peso Delicado</b>"),
      orientation = "v",
      x = 1.02,
      y = 1
    ),
    annotations = list(
      list(
        text = "Fuente: Elaboraci√≥n propia con base en la Encuesta de Nacimientos ‚Äì DANE 2024",
        xref = "paper",
        yref = "paper",
        x = 0.5,
        y = -0.25,
        showarrow = FALSE,
        font = list(size = 10, color = "#666666"),
        xanchor = "center"
      )
    ),
    margin = list(b = 150)
  )
```

El gr√°fico muestra la relaci√≥n entre el tiempo de gestaci√≥n y la presencia de desnutrici√≥n neonatal (‚ÄúPeso Delicado‚Äù) en Bogot√° durante el segundo semestre de 2024. Se observa que en el grupo de 28-37 semanas, la mayor√≠a de los reci√©n nacidos no presenta desnutrici√≥n, mientras que en el grupo de 38-41 semanas predomina la desnutrici√≥n neonatal (‚ÄúS√≠‚Äù). Los nacimientos en los extremos (22-27 semanas y 42 o m√°s semanas) son muy poco frecuentes y aportan poco al total.

### **An√°lisis de la Variable Independiente:** Tipo De Parto

Los resultados del an√°lisis descriptivo del tipo de parto, que incluye las categor√≠as ces√°rea, espont√°neo e instrumentado, se resumen en la Tabla \_\_\_.

```{r tabla3_tipo_parto}
# TABLA 3: DISTRIBUCI√ìN DEL TIPO DE PARTO
tabla_tipo_parto <- Base_datos %>%
  count(Tipo_parto) %>%
  mutate(
    Porcentaje = round(100 * n / sum(n), 1),
    Porcentaje_Acumulado = cumsum(Porcentaje)
  )

kable(tabla_tipo_parto, 
      align = c("l", "c", "r", "r"),
      col.names = c("Tipo de Parto", "Frecuencia", "Porcentaje (%)", "Porcentaje Acumulado (%)"),
      caption = "TABLA 3. DISTRIBUCI√ìN DEL TIPO DE PARTO") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = FALSE,
    font_size = 12
  ) %>%
  add_header_above(c(" " = 1, "Distribuci√≥n de Frecuencias" = 3),
                   background = "#2C3E50", color = "white") %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "15em") %>%
  column_spec(2:4, background = "#F4F6F6") %>%
  row_spec(1:nrow(tabla_tipo_parto), background = c("#FBFCFC", "#F4F6F6")) %>%
  footnote(
    general = "Fuente: Elaboraci√≥n propia con base en la Encuesta de Nacimientos ‚Äì DANE 2024."
  )
```

La variable ‚Äútipo de parto‚Äù muestra una distribuci√≥n claramente dominada por las ces√°reas, que representan el 59.3% de los nacimientos en la muestra analizada. Este resultado refleja una tendencia creciente hacia la utilizaci√≥n de este procedimiento en Bogot√°, en l√≠nea con los reportes recientes de la Secretar√≠a Distrital de Salud, donde tambi√©n se observa un aumento sostenido en la proporci√≥n de partos por ces√°rea en los √∫ltimos a√±os.‚Äã

En segundo lugar, el parto espont√°neo o vaginal sin intervenci√≥n constituye el 38.8% de los nacimientos, mientras que el parto instrumentado (con el uso de herramientas como f√≥rceps o ventosas) representa solo el 1.9% del total. Este √∫ltimo dato evidencia que la aplicaci√≥n de m√©todos instrumentados es poco frecuente en la cohorte estudiada.

ahora, para ver la relacion de esta variable con la variable dependiente estudiada se realiza un gr√°fico de anillos el cual permite visualizar de manera clara c√≥mo se distribuyen los tipos de parto (ces√°rea y espont√°neo) y su relaci√≥n con el estado nutricional neonatal (‚ÄúS√≠‚Äù o ‚ÄúNo‚Äù). Esto ayuda a identificar si existe una diferencia relevante en la prevalencia de desnutrici√≥n neonatal seg√∫n el tipo de parto, facilitando la interpretaci√≥n y el an√°lisis de posibles asociaciones entre esas variables.

```{r grafica3s}
# GR√ÅFICO 3: DISTRIBUCI√ìN DEL TIPO DE PARTO (SUNBURST)
tabla_parto_sunburst <- Base_datos %>%
  count(Tipo_parto, Peso_delicado) %>%
  mutate(
    # Crear jerarqu√≠a: Total -> Tipo_parto -> Peso_delicado
    labels = case_when(
      !is.na(Peso_delicado) ~ paste(Tipo_parto, "-", Peso_delicado),
      TRUE ~ Tipo_parto
    ),
    parents = case_when(
      !is.na(Peso_delicado) ~ Tipo_parto,
      TRUE ~ "Total"
    )
  )

# Agregar el nodo ra√≠z "Total"
nodo_total <- tibble(
  labels = "Total",
  parents = "",
  n = sum(tabla_parto_sunburst$n)
)

# Agregar nodos intermedios (Tipo_parto)
nodos_tipo_parto <- Base_datos %>%
  count(Tipo_parto) %>%
  mutate(
    labels = Tipo_parto,
    parents = "Total"
  ) %>%
  select(labels, parents, n)

# Combinar todos los datos
datos_sunburst <- bind_rows(
  nodo_total,
  nodos_tipo_parto,
  tabla_parto_sunburst %>% select(labels, parents, n)
)

# Crear el gr√°fico sunburst
plot_ly(
  datos_sunburst,
  labels = ~labels,
  parents = ~parents,
  values = ~n,
  type = 'sunburst',
  branchvalues = 'total',
  marker = list(
    colors = c('#9B59B6', '#1ABC9C', '#F39C12', '#E74C3C', '#3498DB', '#F1C40F'),
    line = list(color = '#FFFFFF', width = 2)
  ),
  hovertemplate = paste(
    '<b>%{label}</b><br>',
    'Frecuencia: %{value}<br>',
    'Porcentaje: %{percentParent}<br>',
    '<extra></extra>'
  )
) %>%
  layout(
    title = list(
      text = "<b>Gr√°fico 3. Distribuci√≥n del Tipo de Parto</b><br><sub>Bogot√° - Segundo Semestre 2024</sub>",
      x = 0.5,
      font = list(size = 16)
    ),
    annotations = list(
      list(
        text = "Fuente: Elaboraci√≥n propia con base en la Encuesta de Nacimientos ‚Äì DANE 2024",
        xref = "paper",
        yref = "paper",
        x = 0.5,
        y = -0.1,
        showarrow = FALSE,
        font = list(size = 10, color = "#666666"),
        xanchor = "center"
      )
    ),
    margin = list(b = 100, t = 100)
  )

```

La grafica evidencia diferencias importantes en la distribuci√≥n del bajo peso seg√∫n el tipo de parto. En el grupo de partos por ces√°rea, el 57.3% correspondi√≥ a reci√©n nacidos con desnutrici√≥n, mientras que el 42.3% fue un peso moderado. Esto indica que, dentro de quienes nacen por ces√°rea, existe una mayor proporci√≥n de bajo peso, lo que puede vincularse tanto a indicaciones cl√≠nicas asociadas a embarazos de mayor complejidad como a pr√°cticas hospitalarias reportadas para la ciudad.‚Äã

Al analizar el parto espont√°neo, la tendencia se invierte: el 61.5% de los nacidos por este medio fueron clasificados como reci√©n nacidos sin desnutrici√≥n¬† y el 38.5% como reci√©n nacidos con desnutrici√≥n. Esto sugiere que el parto espont√°neo suele asociarse a mejores condiciones neonatales y puede reflejar embarazos de curso m√°s favorable.

### **An√°lisis de la Variable Independiente:** Edad De La madre¬†

La distribuci√≥n de la edad materna en la muestra se presenta en la Tabla 4. Esta tabla resume la frecuencia y el porcentaje de nacimientos seg√∫n los distintos grupos de edad de la madre, permitiendo identificar los rangos predominantes en la poblaci√≥n de estudio.

```{r tabla4_edad_madre}
# TABLA 4: DISTRIBUCI√ìN POR GRUPOS DE EDAD DE LA MADRE
tabla_edad_madre <- Base_datos %>%
  count(Edad_madre) %>%
  mutate(
    Porcentaje = round(100 * n / sum(n), 1)
  ) %>%
  # Extraer el n√∫mero inicial del rango de edad para ordenar correctamente
  mutate(
    Edad_inicial = as.numeric(gsub("(\\d+)-.*", "\\1", Edad_madre))
  ) %>%
  arrange(Edad_inicial) %>%  # Ordenar por edad de menor a mayor
  mutate(
    Porcentaje_Acumulado = cumsum(Porcentaje)  # Recalcular despu√©s de ordenar
  ) %>%
  select(-Edad_inicial)  # Eliminar columna auxiliar

kable(tabla_edad_madre, 
      align = c("l", "c", "r", "r"),
      col.names = c("Grupo de Edad", "Frecuencia", "Porcentaje (%)", "Porcentaje Acumulado (%)"),
      caption = "TABLA 4. DISTRIBUCI√ìN POR GRUPOS DE EDAD DE LA MADRE") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = FALSE,
    font_size = 12
  ) %>%
  add_header_above(c(" " = 1, "Distribuci√≥n de Frecuencias" = 3),
                   background = "#2C3E50", color = "white") %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "12em") %>%
  column_spec(2:4, background = "#F4F6F6") %>%
  row_spec(1:nrow(tabla_edad_madre), 
           background = rep(c("#FBFCFC", "#F4F6F6"), length.out = nrow(tabla_edad_madre))) %>%
  footnote(
    general = "Fuente: Elaboraci√≥n propia con base en la Encuesta de Nacimientos ‚Äì DANE 2024."
  )
```

La mayor proporci√≥n de nacimientos se concentra en los grupos de madres de 20 a 24 a√±os (22.2%), 25 a 29 a√±os (28.3%) y 30 a 34 a√±os (23.9%), acumulando entre estos tres grupos el 74.4% del total. Esto indica que la mayor√≠a de los nacimientos en Bogot√° durante el periodo analizado corresponden a mujeres en edades reproductivas consideradas √≥ptimas seg√∫n literatura biom√©dica y cifras nacionales (DANE, 2024).‚Äã

Los extremos presentan frecuencias mucho menores: s√≥lo el 0.3% de los partos ocurri√≥ en madres adolescentes entre 10 y 14 a√±os lo cual aunque sea poco es una cifra muy deprimente dado el contexto, y el porcentaje tan bajo con solo 2 casos en el grupo de 50 a 54 a√±os, lo que sugiere que la maternidad extremadamente temprana y avanzada son eventos muy poco comunes en la muestra. El grupo de 15 a 19 a√±os, aunque representa minor√≠a, suma el 8%, indicando la presencia significativa de embarazos adolescentes, un tema relevante para pol√≠ticas de salud p√∫blica.

Las madres de 35 a 39 a√±os representan un 13.5% y de 40 a 44 a√±os un 3.5%, reflejando una transici√≥n reproductiva progresiva hacia edades mayores, pero sin constituir un grupo dominante. Los grupos de 45 a 49 y de 50 a 54 a√±os son pr√°cticamente residuales en la distribuci√≥n observada.

Tambi√©n se llev√≥ a cabo un gr√°fico de barras agrupadas lo cual permite comparar la frecuencia de reci√©n nacidos con y sin peso delicado en cada grupo de edad materna facilitando la identificaci√≥n de grupos de edad donde la prevalencia es mayor o donde la distribuci√≥n es equilibrada.

```{r grafico4_edad_madre_grouped, fig.width=8, fig.height=4.6}
# GR√ÅFICO 4:EDAD MADRE BARRAS AGRUPADAS
#Preparar datos para barras agrupadas

tabla_edad_peso <- Base_datos %>%
  count(Edad_madre, Peso_delicado) %>%
  group_by(Edad_madre) %>%
  mutate(
    Total = sum(n),
    Porcentaje = round(100 * n / Total, 1)
  ) %>%
  ungroup()

# Crear gr√°fico de barras agrupadas
plot_ly(
  tabla_edad_peso,
  x = ~Edad_madre,
  y = ~n,
  color = ~Peso_delicado,
  colors = c('#27AE60', '#E74C3C'),
  type = 'bar',
  text = ~paste0(n, " (", Porcentaje, "%)"),
  textposition = 'outside',
  textfont = list(size = 10),
  hovertemplate = paste(
    '<b>Edad: %{x}</b><br>',
    'Peso Delicado: %{fullData.name}<br>',
    'Frecuencia: %{y}<br>',
    'Porcentaje: %{text}<br>',
    '<extra></extra>'
  )
) %>%
  plotly::layout(
    barmode = 'group',
    title = list(
      text = "<b>Gr√°fico 4. Distribuci√≥n de Peso Delicado seg√∫n Edad Materna</b><br><sub>Bogot√° - Segundo Semestre 2024</sub>",
      x = 0.5,
      font = list(size = 16)
    ),
    xaxis = list(
      title = "<b>Edad de la Madre</b>",
      tickfont = list(size = 10),
      tickangle = -45
    ),
    yaxis = list(
      title = "<b>Frecuencia</b>"
    ),
    legend = list(
      title = list(text = "<b>Peso Delicado</b>"),
      orientation = "h",
      x = 0.5,
      xanchor = "center",
      y = -0.25
    ),
    annotations = list(
      list(
        text = "Fuente: Elaboraci√≥n propia con base en la Encuesta de Nacimientos ‚Äì DANE 2024",
        xref = "paper",
        yref = "paper",
        x = 0.5,
        y = -0.35,
        showarrow = FALSE,
        font = list(size = 10, color = "#666666"),
        xanchor = "center"
      )
    ),
    margin = list(b = 150, l = 80, r = 50, t = 100)
  )
```

Se observa que el mayor volumen de casos se concentra en los grupos de edad de 20 a 34 a√±os, lo que corresponde a los rangos reproductivos m√°s frecuentes en la poblaci√≥n.

Tanto la presencia como la ausencia de peso delicado mantienen proporciones similares en cada grupo de edad, aunque algunos grupos presentan peque√±as diferencias. Por ejemplo, en madres de 25-29 a√±os y 30-34 a√±os, los porcentajes de peso delicado ‚ÄúS√≠‚Äù y ‚ÄúNo‚Äù son casi equivalentes, mientras que en los extremos de edad la cantidad de casos es mucho menor y las proporciones var√≠an m√°s con un porcentaje de 59.5 de ni√±os con desnutrici√≥n en madres mayores de 45 . Destaca que el grupo de 25-29 a√±os posee el mayor n√∫mero absoluto de reci√©n nacidos tanto con como sin peso delicado, y las diferencias porcentuales entre estados nutricionales en la mayor√≠a de los grupos no son dram√°ticas.

### **Analisis de la Variable Independiente:** Controles Prenatales

La distribuci√≥n de los controles prenatales en la muestra se presenta en la Tabla \_\_\_.¬†

```{r tabla5_controles_prenatales}
# TABLA 5: ESTAD√çSTICAS DE CONTROLES PRENATALES
tabla_controles <- Base_datos %>%
  summarise(
    Variable = "Controles Prenatales",
    Media = round(mean(Numero_control_prenatal, na.rm = TRUE), 1),
    DE = round(sd(Numero_control_prenatal, na.rm = TRUE), 1),
    M√≠nimo = min(Numero_control_prenatal, na.rm = TRUE),
    M√°ximo = max(Numero_control_prenatal, na.rm = TRUE),
    Q1 = quantile(Numero_control_prenatal, 0.25, na.rm = TRUE),
    Mediana = median(Numero_control_prenatal, na.rm = TRUE),
    Q3 = quantile(Numero_control_prenatal, 0.75, na.rm = TRUE)
  )

kable(tabla_controles,
      caption = "TABLA 5. ESTAD√çSTICAS DESCRIPTIVAS - CONTROLES PRENATALES",
      align = c("l", "r", "r", "r", "r", "r", "r", "r")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE,
                font_size = 12) %>%
  add_header_above(c(" " = 1, "Medidas de Tendencia Central" = 3, 
                     "Medidas de Dispersi√≥n" = 4),
                   background = "#2C3E50", color = "white") %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "12em") %>%
  footnote(general = "Fuente: Elaboraci√≥n propia con base en la Encuesta de Nacimientos ‚Äì DANE 2024.")
```

El an√°lisis descriptivo del n√∫mero de controles prenatales, muestra que las madres de la muestra tuvieron en promedio 6.9 controles prenatales durante el embarazo, con una desviaci√≥n est√°ndar de 2.8. El rango observado va desde 0 controles (m√≠nimo) hasta un m√°ximo de 25 controles en algunos casos.

Estos resultados indican que, en general, la mayor√≠a de las madres no accedi√≥ al n√∫mero adecuado de controles prenatales, ya que la media no se acerca a la recomendaci√≥n m√≠nima de ocho controles establecida en las gu√≠as nacionales e internacionales. Sin embargo, la presencia de casos con 0 controles evidencia que todav√≠a existen brechas en el acceso a la atenci√≥n materna en ciertos sectores de la poblaci√≥n, lo que puede aumentar los riesgos de desenlaces adversos como la desnutrici√≥n neonatal.

tambien se realizo un histograma de barras agrupadas, donde se visualiza la distribuci√≥n de controles prenatales seg√∫n zonas de riesgo (‚ÄúAdecuado‚Äù, ‚ÄúInsuficiente‚Äù y ‚ÄúCr√≠tico‚Äù) definido por las recomendaciones de la OMS. El eje X muestra el n√∫mero de controles prenatales recibidos y el eje Y la frecuencia absoluta registrada para cada caso.

```{r grafico5_controles_prenatales, fig.width=8, fig.height=4.6}
# GR√ÅFICO 5 INTERACTIVO: DISTRIBUCI√ìN DE CONTROLES PRENATALES CON ZONAS DE RIESGO
library(plotly)
library(dplyr)

# Calcular estad√≠sticas
stats_controles <- Base_datos %>%
  summarise(
    Media = round(mean(Numero_control_prenatal, na.rm = TRUE), 1),
    Mediana = median(Numero_control_prenatal, na.rm = TRUE),
    DE = round(sd(Numero_control_prenatal, na.rm = TRUE), 1),
    Q1 = quantile(Numero_control_prenatal, 0.25, na.rm = TRUE),
    Q3 = quantile(Numero_control_prenatal, 0.75, na.rm = TRUE),
    Min = min(Numero_control_prenatal, na.rm = TRUE),
    Max = max(Numero_control_prenatal, na.rm = TRUE)
  )

# Crear datos de frecuencia
freq_data <- Base_datos %>%
  count(Numero_control_prenatal) %>%
  mutate(
    Zona = case_when(
      Numero_control_prenatal < 4 ~ "Cr√≠tico (<4)",
      Numero_control_prenatal < 8 ~ "Insuficiente (4-7)",
      TRUE ~ "Adecuado (‚â•8)"
    )
  )

# Crear gr√°fico interactivo
fig <- plot_ly() %>%
  # Barras coloreadas por zona de riesgo
  add_bars(
    data = freq_data,
    x = ~Numero_control_prenatal,
    y = ~n,
    color = ~Zona,
    colors = c("Cr√≠tico (<4)" = "#e74c3c", 
               "Insuficiente (4-7)" = "#f39c12", 
               "Adecuado (‚â•8)" = "#27ae60"),
    text = ~n,
    textposition = "outside",
    textfont = list(size = 11, color = "#2C3E50", family = "Arial"),
    hovertemplate = paste(
      "<b>%{x} controles</b><br>",
      "Frecuencia: %{y}<br>",
      "Zona: %{fullData.name}<br>",
      "<extra></extra>"
    )
  ) %>%
  # L√≠nea vertical para la media
  add_segments(
    x = stats_controles$Media,
    xend = stats_controles$Media,
    y = 0,
    yend = max(freq_data$n) * 1.1,
    line = list(color = "#e67e22", width = 3, dash = "dash"),
    showlegend = FALSE,
    hoverinfo = "skip"
  ) %>%
  # L√≠nea vertical para la mediana
  add_segments(
    x = stats_controles$Mediana,
    xend = stats_controles$Mediana,
    y = 0,
    yend = max(freq_data$n) * 1.1,
    line = list(color = "#2C3E50", width = 3, dash = "dot"),
    showlegend = FALSE,
    hoverinfo = "skip"
  ) %>%
  # L√≠nea vertical para recomendaci√≥n OMS (8 controles)
  add_segments(
    x = 8,
    xend = 8,
    y = 0,
    yend = max(freq_data$n) * 1.1,
    line = list(color = "#8e44ad", width = 3, dash = "solid"),
    showlegend = FALSE,
    hoverinfo = "skip"
  ) %>%
  layout(
    title = list(
      text = "<b>FIGURA 5. Distribuci√≥n de Controles Prenatales y Zonas de Riesgo</b><br><sub>Clasificaci√≥n seg√∫n recomendaciones de la OMS</sub>",
      font = list(size = 16, family = "Arial, sans-serif"),
      x = 0
    ),
    xaxis = list(
      title = "<b>N√∫mero de Controles Prenatales</b>",
      titlefont = list(size = 14, family = "Arial, sans-serif"),
      tickfont = list(size = 12),
      dtick = 1,
      gridcolor = "#ecf0f1"
    ),
    yaxis = list(
      title = "<b>Frecuencia Absoluta</b>",
      titlefont = list(size = 14, family = "Arial, sans-serif"),
      tickfont = list(size = 12),
      gridcolor = "#ecf0f1"
    ),
    plot_bgcolor = "white",
    paper_bgcolor = "white",
    hovermode = "closest",
    showlegend = TRUE,
    legend = list(
      title = list(text = "<b>Zona de Riesgo</b>", font = list(size = 12)),
      x = 0.02,
      y = 0.98,
      bgcolor = "rgba(255, 255, 255, 0.95)",
      bordercolor = "#2C3E50",
      borderwidth = 1,
      font = list(size = 11, family = "Arial, sans-serif")
    ),
    margin = list(t = 120, b = 120, l = 80, r = 80),
    annotations = list(
      # Recomendacion OMS
      list(
        x = 0.98,
        y = 0.98,
        xref = "paper",
        yref = "paper",
          text = "<b>Recomendaci√≥n OMS: ‚â•8</b>",
        showarrow = FALSE,
        font = list(size = 11, color = "#8e44ad", family = "Arial"),
        bgcolor = "rgba(142, 68, 173, 0.1)",
        bordercolor = "#8e44ad",
        borderwidth = 2,
        borderpad = 6
      ),
      # Etiqueta Media
      list(
        x = stats_controles$Media,
        y = max(freq_data$n) * 1.12,
        text = paste0("Media: ", stats_controles$Media),
        showarrow = FALSE,
        font = list(size = 10, color = "#e67e22", family = "Arial"),
        bgcolor = "rgba(255, 255, 255, 0.8)",
        bordercolor = "#e67e22",
        borderwidth = 1,
        borderpad = 4
      ),
      # Etiqueta Mediana
      list(
        x = stats_controles$Mediana,
        y = max(freq_data$n) * 1.18,
        text = paste0("Mediana: ", stats_controles$Mediana),
        showarrow = FALSE,
        font = list(size = 10, color = "#2C3E50", family = "Arial"),
        bgcolor = "rgba(255, 255, 255, 0.8)",
        bordercolor = "#2C3E50",
        borderwidth = 1,
        borderpad = 4
      ),
      # Caption
      list(
        x = 0,
        y = -0.18,
        xref = "paper",
        yref = "paper",
        text = "Fuente: Elaboraci√≥n propia con base en la Encuesta de Nacimientos ‚Äì DANE 2024.<br>L√≠nea naranja: media | L√≠nea gris: mediana | L√≠nea morada: recomendaci√≥n OMS (‚â•8 controles)",
        showarrow = FALSE,
        xanchor = "left",
        font = list(size = 9, color = "#7f8c8d", family = "Arial, sans-serif")
      )
    ),
    barmode = "overlay"
  ) %>%
  config(
    displayModeBar = TRUE,
    modeBarButtonsToRemove = c("lasso2d", "select2d"),
    displaylogo = FALSE,
    toImageButtonOptions = list(
      format = "png",
      filename = "figura5_controles_prenatales",
      height = 600,
      width = 1000
    )
  )

fig
```

El an√°lisis revela que la mayor√≠a de las madres recibieron entre 4 y 7 controles prenatales, ubic√°ndose en la zona ‚ÄúInsuficiente‚Äù seg√∫n la OMS; la mediana es 7 y la media 6.9. El grupo ‚ÄúAdecuado‚Äù (8 o m√°s controles) tambi√©n es significativo, aunque menos frecuente. Los controles ‚ÄúCr√≠ticos‚Äù (menos de 4) son minoritarios. Esto indica que, aunque una parte relevante cumple con recomendaciones m√≠nimas, existe oportunidad de mejora en el acceso y seguimiento prenatal para lograr el est√°ndar recomendado (8 o m√°s controles).

### Analisis de la Variable Independiente: Numero de Embarazos

La distribuci√≥n del n√∫mero de embarazos¬† en la muestra se presenta en la Tabla \_\_\_.¬†

```{r tabla6_numero_embarazos}
# TABLA 6: ESTAD√çSTICAS DE N√öMERO DE EMBARAZOS
tabla_embarazos <- Base_datos %>%
  summarise(
    Variable = "N√∫mero de Embarazos",
    Media = round(mean(Numero_embarazos, na.rm = TRUE), 1),
    DE = round(sd(Numero_embarazos, na.rm = TRUE), 1),
    M√≠nimo = min(Numero_embarazos, na.rm = TRUE),
    M√°ximo = max(Numero_embarazos, na.rm = TRUE),
    Q1 = quantile(Numero_embarazos, 0.25, na.rm = TRUE),
    Mediana = median(Numero_embarazos, na.rm = TRUE),
    Q3 = quantile(Numero_embarazos, 0.75, na.rm = TRUE)
  )

kable(tabla_embarazos,
      caption = "TABLA 6. ESTAD√çSTICAS DESCRIPTIVAS - N√öMERO DE EMBARAZOS",
      align = c("l", "r", "r", "r", "r", "r", "r", "r")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE,
                font_size = 12) %>%
  add_header_above(c(" " = 1, "Medidas de Tendencia Central" = 3, 
                     "Medidas de Dispersi√≥n" = 4),
                   background = "#2C3E50", color = "white") %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "12em") %>%
  footnote(general = "Fuente: Elaboraci√≥n propia con base en la Encuesta de Nacimientos ‚Äì DANE 2024.")
```

El an√°lisis descriptivo del n√∫mero de embarazos revela que, en promedio, las mujeres de la muestra han tenido 1.9 embarazos, con una desviaci√≥n est√°ndar de 1.1. El valor m√≠nimo registrado es de 1 embarazo y el m√°ximo alcanza los 14 embarazos.

Estos datos indican que, en general, la mayor√≠a de las mujeres estudiadas tiene entre 1 y 2 embarazos a lo largo de su vida reproductiva, lo que corresponde a un perfil reproductivo moderado, acorde con la tendencia observada en Bogot√° en los √∫ltimos a√±os. La baja desviaci√≥n est√°ndar muestra poca dispersi√≥n, es decir, el n√∫mero de embarazos est√° relativamente concentrado cerca de la media.

Sin embargo, el hecho de que existan mujeres con hasta 14 embarazos resalta la presencia de subgrupos dentro de la poblaci√≥n con comportamientos reproductivos significativamente diferentes al promedio general. Esto puede estar relacionado con factores sociales, culturales o de acceso a servicios de salud y planificaci√≥n familiar.

Seguido a esto se hizo un diagrama de caja o boxplot comparativo, este tipo de gr√°fico representa la distribuci√≥n, tendencia central (media y mediana) y dispersi√≥n del n√∫mero de embarazos en dos grupos: reci√©n nacidos con peso delicado (‚ÄúS√≠‚Äù) y reci√©n nacidos sin peso delicado (‚ÄúNo‚Äù).

```{r grafico6_numero_embarazos_boxplot}
# GR√ÅFICO 6: BOXPLOT COMPARATIVO - N√öMERO DE EMBARAZOS POR PESO DELICADO

stats_embarazos <- Base_datos %>%
  group_by(Peso_delicado) %>%
  summarise(
    Media = round(mean(Numero_embarazos, na.rm = TRUE), 2),
    Mediana = median(Numero_embarazos, na.rm = TRUE),
    Q1 = quantile(Numero_embarazos, 0.25, na.rm = TRUE),
    Q3 = quantile(Numero_embarazos, 0.75, na.rm = TRUE),
    Min = min(Numero_embarazos, na.rm = TRUE),
    Max = max(Numero_embarazos, na.rm = TRUE),
    n = n()
  )


stats_df <- as.data.frame(stats_embarazos)


cat1 <- as.character(stats_df$Peso_delicado[1])
media1 <- stats_df$Media[1]
mediana1 <- stats_df$Mediana[1]
q1_1 <- stats_df$Q1[1]
q3_1 <- stats_df$Q3[1]


cat2 <- as.character(stats_df$Peso_delicado[2])
media2 <- stats_df$Media[2]
mediana2 <- stats_df$Mediana[2]
q1_2 <- stats_df$Q1[2]
q3_2 <- stats_df$Q3[2]

g6_boxplot <- ggplot(Base_datos, aes(x = Peso_delicado, y = Numero_embarazos, fill = Peso_delicado)) +
  geom_boxplot(alpha = 0.7, 
               outlier.shape = 21, 
               outlier.size = 1.5, 
               outlier.fill = "#e74c3c",
               outlier.color = "#c0392b",
               outlier.stroke = 2,
               width = 0.6) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4, 
               color = "#e67e22", fill = "#e67e22", stroke = 1.5) +
  scale_fill_manual(values = c("No" = "#3498db", "S√≠" = "#e74c3c"),
                    name = "Peso Delicado") +
  labs(
    title = "FIGURA 6. Distribuci√≥n del N√∫mero de Embarazos seg√∫n Peso Delicado",
    subtitle = "Comparaci√≥n de medidas de tendencia central y dispersi√≥n",
    x = "Peso Delicado",
    y = "N√∫mero de Embarazos",
    caption = "Fuente: Elaboraci√≥n propia con base en la Encuesta de Nacimientos ‚Äì DANE 2024.\nRombo naranja: media | L√≠nea central: mediana | Caja: Q1-Q3 | Bigotes: rango | Puntos rojos: valores at√≠picos"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    plot.title = element_text(face = "bold", size = 14, hjust = 0, margin = margin(b = 5)),
    plot.subtitle = element_text(size = 10, color = "#7f8c8d", margin = margin(b = 15)),
    plot.caption = element_text(size = 8, hjust = 0, color = "#7f8c8d", 
                                margin = margin(t = 15), lineheight = 1.2),
    legend.position = "none",
    panel.grid.major.x = element_blank(),
    panel.grid.minor = element_blank(),
    panel.grid.major.y = element_line(color = "#ecf0f1", linewidth = 0.5),
    axis.title = element_text(face = "bold", size = 11),
    axis.text = element_text(size = 10),
    axis.text.x = element_text(size = 11, face = "bold"),
    plot.margin = margin(20, 20, 20, 20)
  ) +
  scale_y_continuous(breaks = seq(0, max(Base_datos$Numero_embarazos, na.rm = TRUE), by = 1))


max_y <- max(Base_datos$Numero_embarazos, na.rm = TRUE)


g6_con_stats <- g6_boxplot +
  annotate("rect",
           xmin = 0.55, xmax = 1.45,
           ymin = max_y * 0.82,
           ymax = max_y * 1.0,
           fill = "white", 
           color = if(cat1 == "No") "#3498db" else "#e74c3c", 
           linewidth = 1.2, alpha = 0.95) +
  annotate("text",
           x = 1,
           y = max_y * 0.91,
           label = paste0(cat1, "\n",
                         "Media: ", media1, "\n",
                         "Mediana: ", mediana1, "\n",
                         "Q1: ", q1_1, " | Q3: ", q3_1),
           size = 3, fontface = "bold", color = "#2C3E50", lineheight = 0.9) +
  
  annotate("rect",
           xmin = 1.55, xmax = 2.45,
           ymin = max_y * 0.82,
           ymax = max_y * 1.0,
           fill = "white", 
           color = if(cat2 == "No") "#3498db" else "#e74c3c",
           linewidth = 1.2, alpha = 0.95) +
  annotate("text",
           x = 2,
           y = max_y * 0.91,
           label = paste0(cat2, "\n",
                         "Media: ", media2, "\n",
                         "Mediana: ", mediana2, "\n",
                         "Q1: ", q1_2, " | Q3: ", q3_2),
           size = 3, fontface = "bold", color = "#2C3E50", lineheight = 0.9)

print(g6_con_stats)

```

La figura muestra que en ambos grupos, la media y la mediana son pr√°cticamente iguales: media de 1.88 y mediana de 2 para ‚ÄúS√≠‚Äù, media de 1.86 y mediana de 2 para ‚ÄúNo‚Äù. El rango intercuart√≠lico (Q1 a Q3) es id√©ntico, situ√°ndose entre 1 y 2 embarazos en ambos casos.

¬†En conclusi√≥n, no existen diferencias notables entre los dos grupos en cuanto al n√∫mero de embarazos previos, lo que indica que esta variable no parece estar asociada de manera relevante con la presencia de peso delicado al nacer en la muestra analizada.
:::
::::

# Resultado De Modelo

::: content-block
En este estudio se emplean dos modelos de clasificaci√≥n supervisada para analizar los factores asociados a la desnutrici√≥n neonatal en Bogot√°: K-Nearest Neighbors (KNN) y Regresi√≥n Log√≠stica. Ambos modelos permiten abordar el problema desde perspectivas complementarias y robustecer la interpretaci√≥n de los resultados.

## Modelo KNN ( K- Nearest- Neighbors)

## Modelo **logit (** Regresi√≥n logistica)

```{r cargar modelo logit}
library(tidyverse)
library(caret)
library(pROC)

set.seed(200)

index_muestra <- sample(11873,11873)

index_entrena <- sample(11873,8904)

index_test <- index_muestra[!index_muestra %in% index_entrena]

BD_entrena <- Base_datos[index_entrena, ] %>% 
  filter(!is.na(Peso_delicado))

BD_test <- Base_datos[index_test, ]

BD_entrena_input <- BD_entrena[, 1:5]
BD_entrena_output <- BD_entrena[, 6]

BD_test_input <- BD_test[, -6]
BD_test_output <- BD_test[, 6]

BD_entrena$Peso_delicado <- factor(BD_entrena$Peso_delicado, levels = c("No", "Si"))
BD_test$Peso_delicado <- factor(BD_test$Peso_delicado, levels = c("No", "Si"))

fit_logit <- glm(Peso_delicado ~ Tiempo_gestaci√≥n 
                 + Tipo_parto + Numero_control_prenatal 
                 + Edad_madre + Numero_embarazos, data = BD_entrena, family = binomial())
summary(fit_logit)  

p_hat <- predict(fit_logit, newdata = BD_test, type = "response")

pred_clase <- factor(ifelse(p_hat >= 0.5, "Si", "No"), levels = c("Si","No"))

confusionMatrix(pred_clase, BD_test$Peso_delicado, positive = "Si")

roc_o <- roc(response = BD_test$Peso_delicado, predictor = p_hat, levels = c("No","Si"))
thr   <- coords(roc_o, x = "best", best.method = "youden", ret = "threshold")

umbral<-as.numeric(thr)
pred_clase <- factor(ifelse(p_hat >= umbral, "Si", "No"), levels = c("Si","No"))

confusionMatrix(pred_clase, BD_test$Peso_delicado, positive = "Si")

auc_val <- auc(roc_o)


```

Este modelo busca clasificar, en un lenguaje probabil√≠stico, el porcentaje de aciertos para verdaderos positivos y falsos negativos. Lo que nos posibilita una serie de planteamientos m√°s certeros, ya que considera los niveles de significancia, y en un contexto de un desaf√≠o de salud p√∫blica, las sentencias que consideren otros aspectos y no concluyan, dan cabida a la evoluci√≥n m√©dica y la optimizaci√≥n continua de soluciones √≥ptimas al sistema.

### Tabla De Resumen De Variables 

La siguiente tabla sintetiza el impacto y relevancia estad√≠stica de las variables independientes en el modelo, permitiendo identificar cu√°les factores influyen significativamente en la predicci√≥n de desnutrici√≥n neonatal.

```{r summary}
# Tabla completa del summary con significancia
summary_logit <- summary(fit_logit)
coef_table <- as.data.frame(summary_logit$coefficients)
coef_table$Variable <- rownames(coef_table)
rownames(coef_table) <- NULL

# Limpiar nombres y agregar significancia
coef_table_completa <- coef_table %>%
  mutate(
    Variable = gsub("_", " ", Variable),
    Variable = gsub("Tiempo gestaci√≥n", "Tiempo gestaci√≥n:", Variable),
    Variable = gsub("Tipo parto", "Tipo parto:", Variable),
    Variable = gsub("Edad madre", "Edad madre:", Variable),
    Significancia = ifelse(`Pr(>|z|)` < 0.001, "***",
                          ifelse(`Pr(>|z|)` < 0.01, "**",
                                ifelse(`Pr(>|z|)` < 0.05, "*", "")))
  ) %>%
  rename(
    Estimaci√≥n = Estimate,
    `Error Est√°ndar` = `Std. Error`,
    `Valor z` = `z value`,
    `Valor p` = `Pr(>|z|)`
  ) %>%
  select(Variable, Estimaci√≥n, `Error Est√°ndar`, `Valor z`, `Valor p`, Significancia)

# Tabla con el mismo formato que tus m√©tricas
coef_table_completa %>%
  kable(align = "lccccc", 
        caption = "Resumen del Modelo de Regresi√≥n Log√≠stica") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), 
                full_width = FALSE) %>%
  row_spec(0, background = "#2E86AB", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE) %>%
  column_spec(2, color = "darkblue", bold = TRUE) %>%
  column_spec(6, bold = TRUE) %>%
  footnote(
    general = "*** p < 0.001, ** p < 0.01, * p < 0.05",
    general_title = "Niveles de significancia:"
  )
```

Se procedera a realizar el analisis de la tabla por variable presentada.

1.  Tiempo De Gestacion

Ninguna de las categor√≠as de tiempo de gestaci√≥n (‚Äú28-37 semanas‚Äù, ‚Äú38-41 semanas‚Äù, ‚Äú42 o m√°s semanas‚Äù) presenta asociaci√≥n significativa con la desnutrici√≥n neonatal. Todas tienen valores p muy superiores a 0.05 (por ejemplo, p = 0.916, p = 0.897 y p = 0.999 respectivamente), lo cual indica que, en este modelo, la duraci√≥n del embarazo no afecta de manera relevante la probabilidad de desnutrici√≥n al nacer.

2.  Tipo De Parto

**Tipo parto espont√°neo**: Estimado de -0.4386, error est√°ndar de 0.0612, valor p \<0.0001. Es un coeficiente negativo y peque√±o con bajo error est√°ndar, muy significativo. Indica que el parto espont√°neo reduce el riesgo de desnutrici√≥n neonatal de forma fiable y precisa.

**Tipo parto instrumentado:** Estimado -1.0914, error est√°ndar de 0.2478, valor p \<0.0001. Coeficiente negativo importante, bajo error est√°ndar y m√°xima significancia. Sugiere que el parto instrumentado reduce a√∫n m√°s el riesgo respecto al grupo de referencia.

3.  Controles Prenatales

Estimado de -0.0590, error est√°ndar 0.0109, valor p \<0.0001. El coeficiente negativo, peque√±o y muy preciso (bajo error est√°ndar) respalda que cada control prenatal adicional disminuye el riesgo de desnutrici√≥n con alta fiabilidad.

4.  Edad De La Madre

Ninguna de las categor√≠as de edad materna muestra una asociaci√≥n significativa con la desnutrici√≥n neonatal (por ejemplo, para el grupo 15-19 a√±os: estimaci√≥n = 0.1501, valor p = 0.806; para 25-29 a√±os: estimaci√≥n = -0.1557, valor p = 0.797; para 50-54 a√±os: estimaci√≥n = 13.8664, valor p = 0.992). Todos los valores p est√°n muy por encima de 0.05, descartando un efecto relevante de la edad de la madre en este modelo.

5.  Numero De Embarazos

El n√∫mero de embarazos tampoco muestra significancia estad√≠stica (estimaci√≥n = -0.0461, valor p = 0.118), lo que implica que esta variable no tiene mucha significancia en el desenlace para la muestra estudiada.

6.  Conclusiones

El modelo respalda la importancia del acceso y frecuencia de los controles prenatales, as√≠ como la v√≠a del parto no quir√∫rgica, como factores protectores frente a la desnutrici√≥n neonatal.

Variables como tiempo de gestaci√≥n, edad materna y n√∫mero de embarazos ‚Äîfrecuentemente mencionadas en la literatura perinatal‚Äî no mostraron impacto significativo bajo este enfoque estad√≠stico.

### **M√©tricas De Rendimiento**

En esta secci√≥n se muestran las principales m√©tricas utilizadas para evaluar la efectividad y precisi√≥n del modelo, tales como exactitud, sensibilidad, especificidad y valor predictivo, fundamentales para validar su desempe√±o.

```{r accuracy}
library(kableExtra)
conf_matrix_logit <- confusionMatrix(pred_clase, BD_test$Peso_delicado, positive = "Si")
# Tabla resumen de m√©tricas
metricas_logit <- data.frame(
  M√©trica = c("Accuracy", "Sensibilidad", "Especificidad", 
              "Valor Predictivo Positivo", "Valor Predictivo Negativo",
              "Prevalencia", "AUC"),
  Valor = c(
    round(conf_matrix_logit$overall["Accuracy"], 4),
    round(conf_matrix_logit$byClass["Sensitivity"], 4),
    round(conf_matrix_logit$byClass["Specificity"], 4),
    round(conf_matrix_logit$byClass["Pos Pred Value"], 4),
    round(conf_matrix_logit$byClass["Neg Pred Value"], 4),
    round(conf_matrix_logit$byClass["Prevalence"], 4),
    round(auc_val, 4)
  ),
  Interpretaci√≥n = c(
    "Proporci√≥n total de predicciones correctas",
    "Capacidad de detectar desnutrici√≥n real",
    "Capacidad de identificar correctamente casos sin desnutrici√≥n",
    "Precisi√≥n cuando predice desnutrici√≥n",
    "Precisi√≥n cuando predice no desnutrici√≥n", 
    "Proporci√≥n real de desnutrici√≥n en los datos",
    "Capacidad general de discriminaci√≥n del modelo"
  )
)

metricas_logit %>%
  kable(align = "lcc", caption = "M√©tricas de Rendimiento del Modelo Logit") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), 
                full_width = FALSE) %>%
  row_spec(0, background = "#2E86AB", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE) %>%
  column_spec(2, color = "darkblue", bold = TRUE)

```

Los resultados publicados se consideran muy apropiados, teniendo como referencia el reporte, que nos indica que hay un 84,34% de proporci√≥n total de predicciones correctas, un 89,83% de capacidad de detecci√≥n para casos de desnutrici√≥n real, un 79,12% de capacidad de identificar correctamente casos sin desnutrici√≥n, un 80,33% de precisi√≥n cuando predice desnutrici√≥n, un 89,13% de precisi√≥n cuando predice casos de no desnutrici√≥n, un 48,70% de proporci√≥n real de desnutrici√≥n en los datos y un 87,09% de una capacidad general de discriminaci√≥n de todos los datos.

Bas√°ndonos en el contexto en el cual est√° adaptado el modelo, el valor de inter√©s es la precisi√≥n de detecci√≥n de verdaderos casos de desnutrici√≥n real, ya que es la poblaci√≥n de estudio, a la cual se le va a implementar el tratamiento de atenci√≥n.¬† Adem√°s, permite caracterizar de manera m√°s certera otros casos a lo largo del territorio nacional.

Al igual que con el modelo KNN, los hallazgos con este modelo son positivos , ya que respaldan el buen funcionamiento de los datos seleccionados y el rumbo de la investigaci√≥n.

Las investigaciones que se puedan llevar a cabo con los resultados de este modelo resultan m√°s certeras en la aplicaci√≥n real en un √°mbito de la medicina, ya que, como se mencion√≥ anteriormente, las probabilidades son fundamentales para el planteamiento de hip√≥tesis de soluciones en esta √°rea, ya que hay muchos factores como la variabilidad de la poblaci√≥n, reacciones inesperadas, etc., que obstaculizan las conclusiones inmutables, sobre todo cuando la evoluci√≥n es fundamental para entender las problem√°ticas presentes y probablemente las que padecer√°n las generaciones futuras.

### Matriz de confusi√≥n

La matriz presentada ilustra la clasificaci√≥n real versus la predicha, destacando la capacidad del modelo para identificar correctamente casos de desnutrici√≥n (verdaderos positivos) y no desnutrici√≥n, as√≠ como los errores cometidos.

```{r matrix de confusion}
conf_matrix_logit <- confusionMatrix(pred_clase, BD_test$Peso_delicado, positive = "Si")

# Crear dataframe para la matriz
conf_df_logit <- as.data.frame(conf_matrix_logit$table)
conf_df_logit$Porcentaje <- round(conf_df_logit$Freq / sum(conf_df_logit$Freq) * 100, 1)

ggplot(conf_df_logit, aes(x = Reference, y = Prediction, fill = Freq)) +
  geom_tile(color = "white", alpha = 0.8) +
  geom_text(aes(label = paste(Freq, "\n(", Porcentaje, "%)", sep = "")), 
            color = "white", size = 5, fontface = "bold") +
  scale_fill_gradient(low = "#87CEEB", high = "#1E3F66", name = "Frecuencia") +
  labs(
    title = "Matriz de Confusi√≥n - Modelo Logit",
    subtitle = "Desnutrici√≥n Neonatal",
    x = "Valor Real",
    y = "Predicci√≥n del Modelo"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
    plot.subtitle = element_text(size = 12, hjust = 0.5),
    axis.text = element_text(size = 11),
    axis.title = element_text(face = "bold", size = 12)
  ) +
  coord_fixed()

```

Esta matriz muestra la probabilidad de aciertos en la clasificaci√≥n de los datos brindados en el modelo de entrenamiento, en donde se evidencia que hay una frecuencia m√°s alta para la clasificaci√≥n de verdaderos positivos y falsos negativos, es decir, los aciertos con valores de 43.8% y 40.6%, respectivamente. Los errores de clasificaci√≥n se concentran en clasificar los casos de no desnutrici√≥n con un valor de 10.7%, lo que es aproximadamente el doble del error que se muestra en la clasificaci√≥n de escenarios de desnutrici√≥n con un 5%.

### **Curva ROC**

A continuaci√≥n, se exhibe la curva ROC que refleja la capacidad discriminativa del modelo para diferenciar entre casos positivos y negativos, proporcionando una medida global de su rendimiento a trav√©s del √°rea bajo la curva.

```{r curva roc}
# Crear dataframe para ggplot
roc_data_logit <- data.frame(
  FPR = 1 - roc_o$specificities,
  TPR = roc_o$sensitivities
)

roc_data_logit <- roc_data_logit[order(roc_data_logit$FPR, roc_data_logit$TPR),]

ggplot(roc_data_logit, aes(x = FPR, y = TPR)) +
  geom_segment(aes(x = 0, y = 0, xend = 1, yend = 1), 
               linetype = "dashed", color = "#95a5a6", alpha = 0.8, linewidth = 0.6) +
  geom_ribbon(aes(ymin = 0, ymax = TPR), fill = "#3498db", alpha = 0.15) +
  geom_line(color = "#2980b9", linewidth = 1.5) +
  labs(
    title = "Curva ROC - Modelo Logit",
    subtitle = "Detecci√≥n de Desnutrici√≥n Neonatal",
    x = "Tasa de Falsos Positivos (1 - Especificidad)",
    y = "Tasa de Verdaderos Positivos (Sensibilidad)",
    caption = paste("√Årea bajo la curva (AUC) =", round(auc_val, 4))
  ) +
  theme_minimal(base_size = 13) +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5, color = "black",
                              margin = margin(b = 10)),
    plot.subtitle = element_text(size = 12, hjust = 0.5, color = "black",
                                 margin = margin(b = 15)),
    plot.caption = element_text(size = 10, hjust = 0.5, color = "black",
                                margin = margin(t = 10)),
    axis.title = element_text(color = "black", size = 11),
    axis.title.x = element_text(margin = margin(t = 8)),
    axis.title.y = element_text(margin = margin(r = 8)),
    axis.text = element_text(color = "black"),
    panel.grid.major = element_line(color = "#ecf0f1", linewidth = 0.4),
    panel.grid.minor = element_blank(),
    plot.margin = margin(15, 15, 15, 15)
  ) +
  scale_x_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.2), 
                     expand = expansion(mult = c(0.02, 0.02))) +
  scale_y_continuous(limits = c(0, 1), breaks = seq(0, 1, 0.2), 
                     expand = expansion(mult = c(0.02, 0.02))) +
  annotate("text", x = 0.65, y = 0.25, 
           label = paste("AUC =", round(auc_val, 4)), 
           size = 5, color = "#2c3e50", fontface = "bold")

```

La curva ROC obtenida para el modelo logit muestra un √°rea bajo la curva (AUC) de 0.8709, lo que indica una excelente capacidad discriminativa para diferenciar entre casos de desnutrici√≥n neonatal y no desnutrici√≥n en la poblaci√≥n analizada. Este valor implica que el modelo logra clasificar correctamente aproximadamente un 87% de los pares de casos seleccionados al azar uno con desnutrici√≥n y otro sin ella atribuyendo una mayor probabilidad al caso positivo. Por tanto, los resultados reflejan la solidez de la selecci√≥n de variables explicativas y sugieren que el rendimiento del modelo es suficientemente alto como para considerar su aplicaci√≥n y replicabilidad en otros escenarios o regiones con caracter√≠sticas demogr√°ficas y cl√≠nicas similares.

## **Distribuci√≥n De Probabilidades Predichas**

El siguiente gr√°fico muestra c√≥mo se distribuyen las probabilidades asignadas por el modelo a cada caso, lo que ayuda a evaluar la robustez y separaci√≥n entre grupos seg√∫n el riesgo previsto.

```{r distribucion de probabilidades}
prob_df_logit <- data.frame(
  Probabilidad = p_hat,
  Real = BD_test$Peso_delicado
)

ggplot(prob_df_logit, aes(x = Probabilidad, fill = Real)) +
  geom_density(alpha = 0.6) +
  scale_fill_manual(values = c("Si" = "#e74c3c", "No" = "#3498db")) +
  labs(
    title = "Distribuci√≥n de Probabilidades Predichas",
    subtitle = "Modelo Logit - Desnutrici√≥n Neonatal",
    x = "Probabilidad Predicha de Desnutrici√≥n",
    y = "Densidad",
    fill = "Estado Real"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(face = "bold", size = 16, hjust = 0.5),
    plot.subtitle = element_text(size = 12, hjust = 0.5),
    legend.position = "top"
  ) +
  geom_vline(xintercept = umbral, linetype = "dashed", color = "#2c3e50", linewidth = 1) +
  annotate("text", x = umbral, y = 0, label = paste("Umbral =", round(umbral, 3)), 
           vjust = -1, hjust = -0.1, color = "#2c3e50", fontface = "bold")

```

La curva de distribuci√≥n de probabilidades tiene una forma que tiende a ser muy leptoc√∫rtica. As√≠ que la distribuci√≥n de los datos est√° acumulada alrededor de un valor central, que para el escenario de los casos de no desnutrici√≥n se encuentra aproximadamente en 12,5% de probabilidad predicha y para los eventos de desnutrici√≥n real, aproximadamente un 80%. Sin embargo, se evidencia que la curva de distribuci√≥n no es sim√©trica, por lo cual hay varias curvas que reducen el nivel de confianza de la distribuci√≥n de los mismos (las curvas con el rojo mas fuerte) .¬†

Esta distribuci√≥n presenta un umbral de un 56,3% de probabilidad de predicci√≥n, lo cual es alentador al estar por encima del 50%.

## **Comparaci√≥n: Valores Reales vs Predicciones**

Finalmente, se comparan los datos observados con las predicciones del modelo para corroborar la concordancia y precisi√≥n en la clasificaci√≥n, reforzando la aplicabilidad pr√°ctica del modelo logit en la problem√°tica estudiada.

```{r comparacion}
# Crear tabla comparativa para el modelo logit
tabla_comparativa_logit <- data.frame(
  Observaci√≥n = 1:20,
  Real = BD_test$Peso_delicado[1:20],
  Predicho = pred_clase[1:20],
  `P(Desnutrici√≥n)` = round(p_hat[1:20], 3),
  `P(No Desnutrici√≥n)` = round(1 - p_hat[1:20], 3),
  Resultado = ifelse(BD_test$Peso_delicado[1:20] == pred_clase[1:20], 
                     "Correcto", "Incorrecto")
)

tabla_comparativa_logit %>%
  kable(align = "c", caption = "Comparaci√≥n: Valores Reales vs Predicciones - Modelo Logit") %>%
  kable_styling(bootstrap_options = c("striped", "hover"), 
                full_width = FALSE) %>%
  column_spec(6, color = ifelse(tabla_comparativa_logit$Resultado == "Correcto", 
                                "green", "red")) %>%
  row_spec(0, background = "#2E86AB", color = "white", bold = TRUE)
```

El n√∫mero de aciertos supera el n√∫mero de errores en gran medida, lo que confirma y respalda el correcto funcionamiento del modelo adaptado al tema de investigaci√≥n propuesto.

##  
:::
