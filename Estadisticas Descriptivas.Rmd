---
title: "Análisis de Nacimientos - Bogotá 2024"
author: "Tu Nombre"
date: "2025-01-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r librerias, include=FALSE}
library(readr)
library(dplyr)
library(tidyverse)
library(kableExtra)
library(reactable)
library(htmltools)
library(ggplot2)
```

```{r cargar_datos, include=FALSE}
# Configuración inicial - manteniendo tu código base
BD_EEVV <- read_csv("BD-EEVV-Nacimientos-2024.csv") %>%
  select(COD_DPTO, PESO_NAC, T_GES, TIPO_PARTO, NUMCONSUL, EDAD_MADRE, N_EMB, MES) %>%
  rename(
    Departamento = COD_DPTO,
    Peso_delicado = PESO_NAC,
    Tiempo_gestación = T_GES,
    Tipo_parto = TIPO_PARTO,
    Numero_control_prenatal = NUMCONSUL,
    Edad_madre = EDAD_MADRE,
    Numero_embarazos = N_EMB,
    Mes = MES
  ) %>%
  mutate(
    Numero_control_prenatal = as.numeric(Numero_control_prenatal),
    Numero_embarazos = as.numeric(Numero_embarazos),
    Tiempo_gestación = factor(Tiempo_gestación,
                              levels = c(1, 2, 3, 4, 5),
                              labels = c("22 o menos semanas", "22-27 semanas", "28-37 semanas",
                                         "De 38-41 semanas", "42 o más semanas"))
  ) %>%
  mutate(
    Peso_delicado = ifelse(Peso_delicado %in% c(5, 6, 7, 8, 9), "No", "Si"),
    Peso_delicado = factor(Peso_delicado, levels = c("Si", "No"))
  ) %>%
  mutate(Mes = as.numeric(Mes)) %>%
  filter(Mes %in% c(7, 8, 9, 10, 11, 12)) %>%
  filter(Departamento == 11) %>%
  mutate(Departamento = "Bogotá") %>%
  na.omit()
```

```{r balanceo_datos, include=FALSE}
# Balanceo
set.seed(5)
Si <- BD_EEVV %>% filter(Peso_delicado == "Si")
No <- BD_EEVV %>% filter(Peso_delicado == "No") %>% sample_n(6000)

# Base final
Base_datos <- bind_rows(Si, No) %>%
  select(Tiempo_gestación, Tipo_parto, Numero_control_prenatal,
         Edad_madre, Numero_embarazos, Peso_delicado) %>%
  mutate(
    Tipo_parto = case_when(
      Tipo_parto == 1 ~ "Espontaneo",
      Tipo_parto == 2 ~ "Cesarea",
      Tipo_parto == 3 ~ "Instrumentado"
    ),
    Edad_madre = case_when(
      Edad_madre == 1 ~ "10-14 años",
      Edad_madre == 2 ~ "15-19 años",
      Edad_madre == 3 ~ "20-24 años",
      Edad_madre == 4 ~ "25-29 años",
      Edad_madre == 5 ~ "30-34 años",
      Edad_madre == 6 ~ "35-39 años",
      Edad_madre == 7 ~ "40-44 años",
      Edad_madre == 8 ~ "45-49 años",
      Edad_madre == 9 ~ "50-54 años"
    ),
    Tipo_parto = as.factor(Tipo_parto),
    Edad_madre = as.factor(Edad_madre)
  ) %>%
  filter(complete.cases(.))
```

```{r tabla_variables, echo=FALSE}
# TABLA DE VARIABLES DEL MODELO
variables_modelo <- data.frame(
  Variable = c("Peso", "Tiempo_gestación", "Tipo_parto", 
               "Numero_control_prenatal", "Edad_madre", "Numero_embarazos"),
  Descripción = c("Clasificación del peso al nacer (Normal/Delicado)",
                 "Semanas de gestación", 
                 "Tipo de parto registrado",
                 "Número de controles prenatales realizados",
                 "Grupo etario de la madre",
                 "Número de embarazos previos"),
  Tipo_Variable = c("Categórica (binaria)", "Categórica ordinal", 
                   "Categórica nominal", "Cuantitativa discreta",
                   "Categórica ordinal", "Cuantitativa discreta"),
  Notas = c("Variable dependiente - Peso normal: ≥2500g", 
           "Considerar <37 semanas como prematurez",
           "Espontáneo/Cesárea/Instrumentado",
           "Indicador de acceso a salud prenatal",
           "Rangos definidos por ENSIN",
           "Incluye embarazo actual")
)

kable(variables_modelo, 
      caption = "Tabla 1: Variables del Modelo",
      align = c("l", "l", "l", "l")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE,
                font_size = 12) %>%
  row_spec(0, background = "#2C3E50", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "12em") %>%
  footnote(general = "Fuente: Elaboración propia en base a la Base de Datos de Nacimientos - 2024",
           number = c("Datos corresponden al segundo semestre del año 2024"))
```

```{r tabla1_descriptiva, echo=FALSE}
# TABLA 1: ESTADÍSTICAS DESCRIPTIVAS POR GRUPO DE PESO
tabla_descriptiva <- Base_datos %>%
  group_by(Peso_delicado) %>%
  summarise(
    n = n(),
    Porcentaje = round(100 * n() / nrow(Base_datos), 1),
    Promedio_CP = round(mean(Numero_control_prenatal, na.rm = TRUE), 1),
    DE_CP = round(sd(Numero_control_prenatal, na.rm = TRUE), 1),
    Min_CP = min(Numero_control_prenatal, na.rm = TRUE),
    Max_CP = max(Numero_control_prenatal, na.rm = TRUE),
    Promedio_NE = round(mean(Numero_embarazos, na.rm = TRUE), 1),
    DE_NE = round(sd(Numero_embarazos, na.rm = TRUE), 1),
    Min_NE = min(Numero_embarazos, na.rm = TRUE),
    Max_NE = max(Numero_embarazos, na.rm = TRUE)
  ) %>%
  mutate(Grupo_Peso = ifelse(Peso_delicado == "Si", "Delicado", "Moderado")) %>%
  select(Grupo_Peso, everything(), -Peso_delicado)

# Total de columnas: Grupo_Peso(1) + n(1) + %(1) + 4 CP + 4 NE = 11 columnas
kable(tabla_descriptiva, 
      align = c("l", "c", "r", "r", "r", "r", "r", "r", "r", "r", "r"),
      format.args = list(big.mark = ",", decimal.mark = "."),
      col.names = c("Grupo de Peso", "N", "%", "Media", "DE", "Mín", "Máx", "Media", "DE", "Mín", "Máx"),
      caption = "TABLA 1. ESTADÍSTICAS DESCRIPTIVAS POR GRUPO DE PESO AL NACER") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover"),
    full_width = FALSE,
    font_size = 12,
    position = "center",
    latex_options = "hold_position"
  ) %>%
  add_header_above(c(" " = 1, "Tamaño Muestral" = 2, 
                     "Controles Prenatales" = 4, 
                     "Número de Embarazos" = 4),
                   background = "#2C3E50", color = "white") %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "10em") %>%
  column_spec(2:3, background = "#F4F6F6") %>%
  column_spec(4:11, background = "#FBFCFC") %>%
  footnote(
    general = "Fuente: Elaboración propia con base en la Encuesta de Nacimientos – DANE 2024.",
    number = c("Datos corresponden a nacimientos en Bogotá (julio-diciembre 2024)")
  )
```

```{r tabla2_tiempo_gestacion, echo=FALSE}
# TABLA 2: DISTRIBUCIÓN DEL TIEMPO DE GESTACIÓN
tabla_tiempo_gestacion <- Base_datos %>%
  count(Tiempo_gestación) %>%
  mutate(
    Porcentaje = round(100 * n / sum(n), 1),
    Porcentaje_Acumulado = cumsum(Porcentaje)
  )

kable(tabla_tiempo_gestacion, 
      align = c("l", "c", "r", "r"),
      col.names = c("Tiempo de Gestación", "Frecuencia", "Porcentaje (%)", "Porcentaje Acumulado (%)"),
      caption = "TABLA 2. DISTRIBUCIÓN DEL TIEMPO DE GESTACIÓN") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = FALSE,
    font_size = 12
  ) %>%
  add_header_above(c(" " = 1, "Distribución de Frecuencias" = 3),
                   background = "#2C3E50", color = "white") %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "20em") %>%
  column_spec(2:4, background = "#F4F6F6") %>%
  footnote(
    general = "Fuente: Elaboración propia con base en la Encuesta de Nacimientos – DANE 2024."
  )
```

```{r tabla3_tipo_parto, echo=FALSE}
# TABLA 3: DISTRIBUCIÓN DEL TIPO DE PARTO
tabla_tipo_parto <- Base_datos %>%
  count(Tipo_parto) %>%
  mutate(
    Porcentaje = round(100 * n / sum(n), 1),
    Porcentaje_Acumulado = cumsum(Porcentaje)
  )

kable(tabla_tipo_parto, 
      align = c("l", "c", "r", "r"),
      col.names = c("Tipo de Parto", "Frecuencia", "Porcentaje (%)", "Porcentaje Acumulado (%)"),
      caption = "TABLA 3. DISTRIBUCIÓN DEL TIPO DE PARTO") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = FALSE,
    font_size = 12
  ) %>%
  add_header_above(c(" " = 1, "Distribución de Frecuencias" = 3),
                   background = "#2C3E50", color = "white") %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "15em") %>%
  column_spec(2:4, background = "#F4F6F6") %>%
  row_spec(1:nrow(tabla_tipo_parto), background = c("#FBFCFC", "#F4F6F6")) %>%
  footnote(
    general = "Fuente: Elaboración propia con base en la Encuesta de Nacimientos – DANE 2024."
  )
```

```{r tabla4_edad_madre, echo=FALSE}
# TABLA 4: DISTRIBUCIÓN POR GRUPOS DE EDAD DE LA MADRE
tabla_edad_madre <- Base_datos %>%
  count(Edad_madre) %>%
  mutate(
    Porcentaje = round(100 * n / sum(n), 1),
    Porcentaje_Acumulado = cumsum(Porcentaje)
  ) %>%
  arrange(desc(n))  # Ordenar por frecuencia descendente

kable(tabla_edad_madre, 
      align = c("l", "c", "r", "r"),
      col.names = c("Grupo de Edad", "Frecuencia", "Porcentaje (%)", "Porcentaje Acumulado (%)"),
      caption = "TABLA 4. DISTRIBUCIÓN POR GRUPOS DE EDAD DE LA MADRE") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = FALSE,
    font_size = 12
  ) %>%
  add_header_above(c(" " = 1, "Distribución de Frecuencias" = 3),
                   background = "#2C3E50", color = "white") %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "12em") %>%
  column_spec(2:4, background = "#F4F6F6") %>%
  row_spec(1:nrow(tabla_edad_madre), 
           background = rep(c("#FBFCFC", "#F4F6F6"), length.out = nrow(tabla_edad_madre))) %>%
  footnote(
    general = "Fuente: Elaboración propia con base en la Encuesta de Nacimientos – DANE 2024."
  )
```

```{r tablas5_cruzadas, echo=FALSE}
# TABLA 5: TABLAS CRUZADAS
# Función para crear tablas cruzadas completas
crear_tabla_cruzada_completa <- function(data, variable, nombre_var) {
  # Total general para porcentajes
  total_general <- nrow(data)
  
  # Crear tabla de frecuencias
  tabla_freq <- data %>%
    count({{variable}}, Peso_delicado) %>%
    mutate(Porcentaje = round(100 * n / total_general, 1))
  
  # Pivotar para obtener formato ancho
  tabla_ancha <- tabla_freq %>%
    select({{variable}}, Peso_delicado, n, Porcentaje) %>%
    pivot_wider(
      names_from = Peso_delicado,
      values_from = c(n, Porcentaje),
      values_fill = list(n = 0, Porcentaje = 0)
    )
  
  # Renombrar columnas en el orden correcto
  if("n_Si" %in% names(tabla_ancha)) {
    tabla_ancha <- tabla_ancha %>%
      select({{variable}}, n_Si, Porcentaje_Si, n_No, Porcentaje_No) %>%
      rename(
        !!nombre_var := {{variable}},
        "n Sí" = n_Si,
        "% Sí" = Porcentaje_Si,
        "n No" = n_No,
        "% No" = Porcentaje_No
      )
  }
  
  return(tabla_ancha)
}

# 5a: Tiempo de gestación vs Peso
tabla_cruzada_tiempo <- crear_tabla_cruzada_completa(Base_datos, Tiempo_gestación, "Tiempo de Gestación")

kable(tabla_cruzada_tiempo, 
      align = c("l", "r", "r", "r", "r"),
      col.names = c("Tiempo de Gestación", "n Sí", "% Sí", "n No", "% No"),
      caption = "TABLA 5A. DISTRIBUCIÓN CRUZADA - TIEMPO DE GESTACIÓN Y PESO AL NACER") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover"),
    full_width = FALSE,
    font_size = 11
  ) %>%
  add_header_above(c(" " = 1, "Delicado (Sí)" = 2, "Delicado (No)" = 2),
                   background = c("white", "#E74C3C", "#27AE60"),
                   color = c("black", "white", "white")) %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "15em") %>%
  column_spec(2:3, background = "#FADBD8") %>%
  column_spec(4:5, background = "#D5F4E6") %>%
  footnote(general = "Fuente: Elaboración propia con base en la Encuesta de Nacimientos – DANE 2024.")

# 5b: Tipo de parto vs Peso  
tabla_cruzada_parto <- crear_tabla_cruzada_completa(Base_datos, Tipo_parto, "Tipo de Parto")

kable(tabla_cruzada_parto, 
      align = c("l", "r", "r", "r", "r"),
      col.names = c("Tipo de Parto", "n Sí", "% Sí", "n No", "% No"),
      caption = "TABLA 5B. DISTRIBUCIÓN CRUZADA - TIPO DE PARTO Y PESO AL NACER") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover"),
    full_width = FALSE,
    font_size = 11
  ) %>%
  add_header_above(c(" " = 1, "Delicado (Sí)" = 2, "Delicado (No)" = 2),
                   background = c("white", "#E74C3C", "#27AE60"),
                   color = c("black", "white", "white")) %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "12em") %>%
  column_spec(2:3, background = "#FADBD8") %>%
  column_spec(4:5, background = "#D5F4E6") %>%
  footnote(general = "Fuente: Elaboración propia con base en la Encuesta de Nacimientos – DANE 2024.")

# 5c: Edad de la madre vs Peso
tabla_cruzada_edad <- crear_tabla_cruzada_completa(Base_datos, Edad_madre, "Edad de la Madre")

kable(tabla_cruzada_edad, 
      align = c("l", "r", "r", "r", "r"),
      col.names = c("Edad de la Madre", "n Sí", "% Sí", "n No", "% No"),
      caption = "TABLA 5C. DISTRIBUCIÓN CRUZADA - EDAD DE LA MADRE Y PESO AL NACER") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover"),
    full_width = FALSE,
    font_size = 11
  ) %>%
  add_header_above(c(" " = 1, "Delicado (Sí)" = 2, "Delicado (No)" = 2),
                   background = c("white", "#E74C3C", "#27AE60"),
                   color = c("black", "white", "white")) %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "12em") %>%
  column_spec(2:3, background = "#FADBD8") %>%
  column_spec(4:5, background = "#D5F4E6") %>%
  footnote(general = "Fuente: Elaboración propia con base en la Encuesta de Nacimientos – DANE 2024.")
```


```{r tabla6_controles_prenatales, echo=FALSE}
# TABLA 6: ESTADÍSTICAS DE CONTROLES PRENATALES
tabla_controles <- Base_datos %>%
  summarise(
    Variable = "Controles Prenatales",
    Media = round(mean(Numero_control_prenatal, na.rm = TRUE), 1),
    DE = round(sd(Numero_control_prenatal, na.rm = TRUE), 1),
    Mínimo = min(Numero_control_prenatal, na.rm = TRUE),
    Máximo = max(Numero_control_prenatal, na.rm = TRUE),
    Q1 = quantile(Numero_control_prenatal, 0.25, na.rm = TRUE),
    Mediana = median(Numero_control_prenatal, na.rm = TRUE),
    Q3 = quantile(Numero_control_prenatal, 0.75, na.rm = TRUE)
  )

kable(tabla_controles,
      caption = "TABLA 6. ESTADÍSTICAS DESCRIPTIVAS - CONTROLES PRENATALES",
      align = c("l", "r", "r", "r", "r", "r", "r", "r")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE,
                font_size = 12) %>%
  add_header_above(c(" " = 1, "Medidas de Tendencia Central" = 3, 
                     "Medidas de Dispersión" = 4),
                   background = "#2C3E50", color = "white") %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "12em") %>%
  footnote(general = "Fuente: Elaboración propia con base en la Encuesta de Nacimientos – DANE 2024.")
```

```{r grafico_controles, echo=FALSE, fig.width=10, fig.height=6}
# GRÁFICO: DISTRIBUCIÓN DE CONTROLES PRENATALES
library(ggplot2)

ggplot(Base_datos, aes(x = Numero_control_prenatal)) +
  geom_histogram(aes(y = after_stat(density)), bins = 30, fill = "#3498DB", 
                 color = "white", alpha = 0.7) +
  geom_density(color = "#E74C3C", linewidth = 1.2) +
  geom_vline(aes(xintercept = mean(Numero_control_prenatal)), 
             color = "#27AE60", linetype = "dashed", linewidth = 1) +
  labs(title = "Distribución del Número de Controles Prenatales",
       subtitle = "Bogotá - Segundo Semestre 2024",
       x = "Número de Controles Prenatales",
       y = "Densidad",
       caption = "Fuente: Elaboración propia - DANE 2024") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
        plot.subtitle = element_text(hjust = 0.5, size = 12),
        axis.title = element_text(face = "bold"),
        panel.grid.minor = element_blank())
```

```{r tabla7_numero_embarazos, echo=FALSE}
# TABLA 7: ESTADÍSTICAS DE NÚMERO DE EMBARAZOS
tabla_embarazos <- Base_datos %>%
  summarise(
    Variable = "Número de Embarazos",
    Media = round(mean(Numero_embarazos, na.rm = TRUE), 1),
    DE = round(sd(Numero_embarazos, na.rm = TRUE), 1),
    Mínimo = min(Numero_embarazos, na.rm = TRUE),
    Máximo = max(Numero_embarazos, na.rm = TRUE),
    Q1 = quantile(Numero_embarazos, 0.25, na.rm = TRUE),
    Mediana = median(Numero_embarazos, na.rm = TRUE),
    Q3 = quantile(Numero_embarazos, 0.75, na.rm = TRUE)
  )

kable(tabla_embarazos,
      caption = "TABLA 7. ESTADÍSTICAS DESCRIPTIVAS - NÚMERO DE EMBARAZOS",
      align = c("l", "r", "r", "r", "r", "r", "r", "r")) %>%
  kable_styling(bootstrap_options = c("striped", "hover"),
                full_width = FALSE,
                font_size = 12) %>%
  add_header_above(c(" " = 1, "Medidas de Tendencia Central" = 3, 
                     "Medidas de Dispersión" = 4),
                   background = "#2C3E50", color = "white") %>%
  row_spec(0, background = "#34495E", color = "white", bold = TRUE) %>%
  column_spec(1, bold = TRUE, width = "12em") %>%
  footnote(general = "Fuente: Elaboración propia con base en la Encuesta de Nacimientos – DANE 2024.")
```

```{r grafico_embarazos, echo=FALSE, fig.width=10, fig.height=6}
# GRÁFICO: DISTRIBUCIÓN DE NÚMERO DE EMBARAZOS
ggplot(Base_datos, aes(x = Numero_embarazos)) +
  geom_histogram(aes(y = after_stat(density)), bins = 20, fill = "#9B59B6", 
                 color = "white", alpha = 0.7) +
  geom_density(color = "#E74C3C", linewidth = 1.2) +
  geom_vline(aes(xintercept = mean(Numero_embarazos)), 
             color = "#27AE60", linetype = "dashed", linewidth = 1) +
  labs(title = "Distribución del Número de Embarazos",
       subtitle = "Bogotá - Segundo Semestre 2024",
       x = "Número de Embarazos",
       y = "Densidad",
       caption = "Fuente: Elaboración propia - DANE 2024") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5, face = "bold", size = 16),
        plot.subtitle = element_text(hjust = 0.5, size = 12),
        axis.title = element_text(face = "bold"),
        panel.grid.minor = element_blank())
```

```{r tabla8_resumen, echo=FALSE}
# TABLA 8: RESUMEN GENERAL DE OBSERVACIONES
tabla_resumen <- Base_datos %>%
  count(Peso_delicado) %>%
  mutate(
    Porcentaje = round(100 * n / sum(n), 1),
    `Porcentaje Acumulado (%)` = cumsum(Porcentaje),
    Ranking = row_number(),
    Categoria = ifelse(Peso_delicado == "Si", "Peso Delicado", "Peso Moderado")
  ) %>%
  select(Categoria, n, Porcentaje, `Porcentaje Acumulado (%)`, Ranking)

kable(tabla_resumen, 
      align = c("l", "c", "r", "r", "c"),
      col.names = c("Categoría de Peso", "Frecuencia", "Porcentaje (%)", "Porcentaje Acumulado (%)", "Ranking"),
      caption = "TABLA 8. RESUMEN GENERAL DE OBSERVACIONES POR CATEGORÍA DE PESO") %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed"),
    full_width = FALSE,
    font_size = 12,
    html_font = "Arial"
  ) %>%
  add_header_above(c(" " = 1, 
                     "Distribución de Frecuencias" = 3,
                     "Posición" = 1),
                   background = c("#2C3E50", "#16A085", "#2980B9")) %>%
  row_spec(0, background = "#2C3E50", color = "white", bold = TRUE) %>%
  row_spec(1, background = "#E8F6F3", bold = TRUE) %>%
  row_spec(2, background = "#EBF5FB") %>%
  column_spec(1, bold = TRUE, width = "15em") %>%
  column_spec(2, width = "6em", background = "#F4F6F6") %>%
  column_spec(3:4, width = "8em") %>%
  column_spec(5, width = "5em", background = "#FEF9E7") %>%
  footnote(
    general = "Fuente: Elaboración propia con base en la Encuesta de Nacimientos – DANE 2024."
  )
```

```{r tabla_interactiva, echo=FALSE}
# TABLA INTERACTIVA FINAL
reactable(
  Base_datos,
  defaultPageSize = 15,
  showPageSizeOptions = TRUE,
  pageSizeOptions = c(10, 15, 25, 50, 100),
  filterable = TRUE,
  searchable = TRUE,
  sortable = TRUE,
  resizable = TRUE,
  striped = TRUE,
  highlight = TRUE,
  bordered = FALSE,
  wrap = FALSE,
  showSortable = TRUE,
  defaultColDef = colDef(
    header = function(value) {
      name <- gsub("_", " ", value)
      name <- gsub("([a-z])([A-Z])", "\\1 \\2", name)
      tools::toTitleCase(tolower(name))
    },
    cell = function(value) {
      if (is.numeric(value)) {
        if (value == round(value)) {
          format(value, big.mark = ",", scientific = FALSE)
        } else {
          format(round(value, 2), nsmall = 2, big.mark = ",", scientific = FALSE)
        }
      } else {
        as.character(value)
      }
    },
    align = "center",
    minWidth = 100,
    headerStyle = list(
      background = "#2C3E50",
      color = "white",
      fontWeight = "600",
      borderBottom = "2px solid #dee2e6",
      fontSize = "13px"
    ),
    style = list(
      fontSize = "12px",
      fontFamily = "Arial, sans-serif"
    )
  ),
  style = list(
    fontFamily = "Arial, sans-serif",
    fontSize = "13px"
  ),
  theme = reactableTheme(
    stripedColor = "#f8f9fa",
    highlightColor = "#e9ecef",
    cellPadding = "8px 12px",
    backgroundColor = "#ffffff",
    borderColor = "#dee2e6",
    style = list(
      fontFamily = "Arial, -apple-system, BlinkMacSystemFont, sans-serif"
    ),
    searchInputStyle = list(
      width = "100%",
      padding = "8px 12px",
      border = "1px solid #ced4da",
      borderRadius = "4px",
      fontSize = "14px",
      marginBottom = "10px"
    ),
    headerStyle = list(
      borderBottom = "2px solid #495057",
      fontSize = "14px",
      backgroundColor = "#2C3E50",
      color = "white"
    )
  ),
  columns = list(
    Tiempo_gestación = colDef(
      name = "Tiempo Gestación",
      minWidth = 180,
      filterable = TRUE,
      align = "left"
    ),
    Edad_madre = colDef(
      name = "Edad Madre", 
      minWidth = 120,
      filterable = TRUE
    ),
    Peso_delicado = colDef(
      name = "Peso Delicado",
      style = function(value) {
        color <- ifelse(value == "Si", "#E74C3C", "#27AE60")
        list(fontWeight = "bold", color = color)
      }
    )
  )
)

# Fuente de la tabla interactiva
tags$div(
  style = "margin-top: 20px; font-size: 12px; color: #666; font-style: italic; text-align: center;",
  "Fuente: Elaboración propia con base en la Encuesta de Nacimientos – DANE 2024"
)
```
